<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html lang="ko">
<head>
   	<%@ include file="/inc/head.jspf" %>
</head>
<body>
<div id="wrap">
	<header>
		<c:import url='/main/head.do' />
	</header>
	<main class="payment">
		<input type="hidden" id="parkingChk" value="${not empty parkingList ? 'true' : 'false'}"/>
		<input type="hidden" id="applyId" value="${applyId}"/>
		<div class="dim"></div>
		<section id="container">
			<section id="container-inner">
				<!--  pc  -->
				<form name="mainManageLeftForm" id="mainManageLeftForm" method="post">
					<article id="lnbMenu">
						<article>
							<div>
								<spring:message code="payment.title"/>
							</div>
						</article>
						<article>
							<ul>
								<li class="${subMenu2 eq '선불(카드) 신청안내' ? 'active' : ''}" id="lefttab1">
									<a href="javascript:fCallUrl('111101','111001','/payment/select_payment_guide.do')">
										<spring:message code="payment.tab1"/>
									</a>
								</li>
								<li class="${subMenu2 eq '선불(카드) 신청' ? 'active' : ''}" id="lefttab2">
									<a href="javascript:fCallUrl('111102','111002','/payment/select_payment_apply.do')">
										<spring:message code="payment.tab2"/>
									</a>
								</li>
								<li class="${subMenu2 eq '선불(카드) 카드 등록' ? 'active' : ''}" id="lefttab3">
									<a href="javascript:fCallUrl('111103','111003','/payment/select_payment_card.do')">
										<spring:message code="payment.tab3"/>
									</a>
								</li>
								<li class="${subMenu2 eq '선불(카드) 차량 조회' ? 'active' : ''}"  id="lefttab4">
									<a href="javascript:fCallUrl('111104','111004','/payment/select_payment_car.do')">
										<spring:message code="payment.tab4"/>
									</a>
								</li>
							</ul>
						</article>
						<div class="menu-btn"></div>
					</article>
					<!-- Mobile -->
					<section class="gnbNav-inner">
						<c:if test="${empty SessionUtils}">
							<article>
								<a href="store/login.do"><spring:message code="main.loginMessage"/></a>
							</article>
						</c:if>
						<c:if test="${not empty SessionUtils}">
							<article>
								<spring:message code="main.loginCheck"/>
							</article>
						</c:if>
						<article>
							<nav id="menuList">
								<div>
									<a href="">
										<spring:message code="payment.title"/>
									</a>
									<ul class="menu-list">
										<li>
											<a href="javascript:fCallUrl('111101','111001','/payment/select_payment_guide.do')">
												<spring:message code="payment.tab1"/>
											</a>
										</li>
										<li>
											<a href="javascript:fCallUrl('111102','111002','/payment/select_payment_apply.do')">
												<spring:message code="payment.tab2"/>
											</a>
										</li>
										<li>
											<a href="javascript:fCallUrl('111103','111003','/payment/select_payment_card.do')">
												<spring:message code="payment.tab3"/>
											</a>
										</li>
										<li>
											<a href="javascript:fCallUrl('111104','111004','/payment/select_payment_car.do')">
												<spring:message code="payment.tab4"/>
											</a>
										</li>
									</ul>
								</div>
							</nav>
						</article>
							
						<c:if test="${empty SessionUtils}">
							<article>
								<div><a href="/store/login.do"><spring:message code="main.login"/></a></div>
								<div><a href="/store/signup.do"><spring:message code="main.signup"/></a></div>
							</article>
						</c:if>
						<c:if test="${not empty SessionUtils}">
							<article>
								<div><a href="/login/actionLogout.do"><spring:message code="main.logout"/></a></div>
							</article>
						</c:if>
					</section>
					
				<input type="hidden" name="menuParamNo"      value="111101"/>
				<input type="hidden" name="upperMenuParamId" value="111001"/>
				<input type="hidden" name="subMenu1"         value="111101"/>
				<input type="hidden" name="subMenu2"         value="111101"/>
					
				</form>
				<article class="content">
					<ul>
						<li class="title"><spring:message code="payment.title"/></li>
						<li><spring:message code="payment.subTitle1"/></li>
					</ul>
					<!--  content area start -->
					<div id="content">
						<div class="contents_wrap">
							<div id="stopless-calculate" class="contents">
								<dl class="txt_wrap">
									<form id="paymentform" name="paymentform" method="post">
										<input type="hidden" id="applyId"  name="applyId"	value="${sessionScope.USER.userId}"/>
										<input type="hidden" id="userNm"   name="userNm"	value="${sessionScope.USER.userNm}"/>
										<input type="hidden" id="useraddr" name="useraddr"  value="(${sessionScope.USER.zipCode}) ${sessionScope.USER.address} ${sessionScope.USER.address2}"/>
										<input type="hidden" id="step"     name="step"		value="${step}"/>
									</form>
									<dd class="con_txt">
										<ul id="tabMenu">
											<li id="step1" data-tab="tab1" data-href="javascript:fCallUrl('111101', '111001', '/payment/select_payment_guide.do');"><spring:message code="payment.tab1"/></li>
											<li id="step2" data-tab="tab2" data-href="javascript:fCallUrl('111102', '111002', '/payment/select_payment_apply.do');"><spring:message code="payment.tab2"/></li>
											<li id="step3" data-tab="tab3" data-href="javascript:fCallUrl('111103', '111003', '/payment/select_payment_card.do');"><spring:message code="payment.tab3"/></li>
											<li id="step4" data-tab="tab4" data-href="javascript:fCallUrl('111104', '111004', '/payment/select_payment_car.do');"><spring:message code="payment.tab4"/></li>
										</ul>
									</dd>
								</dl>
								<section id="tab1" class="tabcontent on">
									<article>
										<dl class="cont-block">
											<dt class="subheading"><spring:message code="payment.tab1.content3"/></dt>
											<dd class="cont"><spring:message code="payment.tab1.content4"/></dd>
										</dl>
										<dl class="cont-block">
											<dt class="subheading"><spring:message code="payment.tab1.content5"/></dt>
											<dd class="cont"><spring:message code="payment.tab1.content6"/></dd>
										</dl>
										<dl class="cont-block">
											<dt class="subheading"><spring:message code="payment.tab1.content7"/></dt>
											<dd class="cont"><spring:message code="payment.tab1.content8"/></dd>
											<dd class="cont"><spring:message code="payment.tab1.content9"/></dd>
										</dl>
										<dl class="cont-block">
											<dt class="subheading"><spring:message code="payment.tab1.content10"/></dt>
											<dd class="cont"><spring:message code="payment.tab1.content11"/></dd>
											<dd class="cont"><spring:message code="payment.tab1.content12"/></dd>
											<dd class="cont"><spring:message code="payment.tab1.content13"/></dd>
											<dd class="cont"><spring:message code="payment.tab1.content14"/></dd>
											<dd class="cont"><spring:message code="payment.tab1.content15"/></dd>
										</dl>
										<dl class="cont-block">
											<dt class="subheading"><spring:message code="payment.tab1.content16"/></dt>
											<dd class="cont"><spring:message code="payment.tab1.content17"/></dd>
										</dl>
										<dl class="cont-block">
											<dt class="cont-bullet"><spring:message code="payment.tab1.content20"/></dt>
										</dl>
										<div class="btn-row">
											<ul class="btn-list">
												<li class="one-btn"><a href="javascript:void(0);" class="btn-type1" id="btn_go_step2"><spring:message code="payment.tab1.content21"/></a></li>
											</ul>
										</div>										
										<!-- 										
										<ul class="btn-list">
											<li class="btn ex">
												<a href="javascript:void(0);" class="btn-type1" id="btn_go_step2">주차요금선납 서비스신청</a>
											</li>
										</ul>  
										-->
										<!-- ???  --> 
									</article>
								</section> 
								<section id="tab2" class="tabcontent">
									<article>
										<h2 class="subheading"><spring:message code="payment.tab2.content1"/></h2>
										<div class="con_txt">
											<div class="cont_board">
												<table class="contable">
													<caption class="sr-only"><spring:message code="payment.tab2.content2"/></caption>
													<colgroup>
														<col style="width:20%;">
														<col style="width:80%;">
													</colgroup>
													<tbody>
														<tr>
															<th><spring:message code="payment.tab2.content3"/></th>
															<td><input type="text" id="useraddrnm" name="useraddrnm" readOnly="readOnly" value="<c:out value="${SessionUtils.get(\"storeNm\")}" />"/></td>
														</tr>
														<tr>
															<th><spring:message code="payment.tab2.content4"/></th>
															<td><input type="text" id="useraddrtxt" name="useraddrtxt" value="<c:out value="${SessionUtils.get(\"addr\")}" />"/>
															<%-- <c:choose>
																<c:when test="empty ${sessionScope.USER.zipCode}">
																	${sessionScope.USER.address} ${sessionScope.USER.address2}
																</c:when>
																<c:otherwise>
																	(${sessionScope.USER.zipCode}) ${sessionScope.USER.address} ${sessionScope.USER.address2}
																</c:otherwise>
															</c:choose> --%>
															</td>
														</tr>
														<tr>
															<th><spring:message code="payment.tab2.content5"/></th>
															<td>
																<ul class="phone">
																	<li><input type="text" id="phone1" name="phone1" maxlength="3" value="010" /><span>-</span></li>
																	<li><input type="text" id="phone2" name="phone2" maxlength="4" /><span>-</span></li>
																	<li><input type="text" id="phone3" name="phone3" maxlength="4" /></li>
																</ul>
																<div class="blue" style="margin-bottom: 10px;">
																	<p><spring:message code="payment.tab2.content6"/></p>
																</div>
															</td>
														</tr>
														<tr>
															<th><spring:message code="payment.tab2.content7"/></th>
															<td>
																<ul class="phone business-registration">
																	<li><input type="text" id="busRgtNo1" name="busRgtNo1" maxlength="3" /><span>-</span></li>
																	<li><input type="text" id="busRgtNo2" name="busRgtNo2" maxlength="2" /><span>-</span></li>
																	<li><input type="text" id="busRgtNo3" name="busRgtNo3" maxlength="5" /></li>
																</ul>
															</td>
														</tr>
														<tr>
															<th><spring:message code="payment.tab2.content8"/></th>
															<td class="workplace-name"><input type="text" id="busNm" name="busNm" maxlength="50" /></td>						
														</tr>
														<tr>
															<th><spring:message code="payment.tab2.content9"/></th>
															<td>
																<ul class="phone business-registration">
																	<li><input type="text" id="busTelNo1" name="busTelNo1" maxlength="3" /><span>-</span></li>
																	<li><input type="text" id="busTelNo2" name="busTelNo2" maxlength="4" /><span>-</span></li>
																	<li><input type="text" id="busTelNo3" name="busTelNo3" maxlength="4" /></li>
																</ul>
															</td>
														</tr>
														<tr>
															<th><spring:message code="payment.tab2.content10"/></th>
															<td class="parking-arrow">
																<p><spring:message code="payment.tab2.content11"/></p>
																<ul class="parking-info">	
																	<!-- <li><a href="#layer-parking" class="btn-type1" id="parkingAddBtn">주차장 추가</a></li> -->
																	<li><a href="#;" class="btn-type1" id="parkingMapAddBtn"><spring:message code="payment.tab2.content12"/></a></li>
																	<li><a href="#;" class="btn-type1" id="parkingAllAddBtn"><spring:message code="payment.tab2.content13"/></a></li>
																</ul>
																<div class="parking-scroll">
																	<div class="parking-scroll-inner">
																		<table class="parking-table pc">
																			<caption class="sr-only"><spring:message code="payment.tab2.content14"/></caption>
																			<colgroup>
																				<col style="width: 26%;" />
																				<col style="width: 26%;" />
																				<col style="width: 26%;" />
																				<col style="width: 20%;" />
																			</colgroup>
																			<thead>
																				<tr>
																					<th scope="col"><spring:message code="payment.tab2.content15"/></th>
																					<th scope="col"><spring:message code="payment.tab2.content16"/></th>
																					<th scope="col"><spring:message code="payment.tab2.content17"/></th>
																					<th scope="col"><spring:message code="payment.tab2.content18"/></th>
																				</tr>
																			</thead>
																			<tbody id="pcParkingList">
																			</tbody>
																		</table>
																		
																		<div id ="mobileParkingList">
																		</div>
																	</div>
																</div>
															</td>
														</tr>
													</tbody>
												</table>
											</div>
										</div>
										
									</article>
									<article>
										<!--  수정  -->
										<div id="layer-parking" class="pop-layer">
											<div class="pop-container">
												<div class="pop-conts">
													<div class="pop-tit">
														<ul>
															<li><spring:message code="payment.tab2.content19"/></li>
															<li><a href="javascript:void(0)" class="icon-close btn-Close"></a></li>
														</ul>
													</div>
													<div class="pop-cont">					        	
														<article id="parkingTab1" class="parking-content on">
															<!-- 					        		
															<ul class="parking-dong-list">
										        				<li><a href="">대산동</a></li>
										        				<li><a href="">소사본동</a></li>
										        				<li><a href="">범안동</a></li>
										        				<li><a href="">신중동</a></li>
										        				<li><a href="">부천동</a></li>
										        				<li><a href="">심곡동</a></li>
										        				<li><a href="">상동</a></li>
										        				<li><a href="">오정동</a></li>
										        				<li><a href="">성곡동</a></li>
										        				<li><a href="">중동</a></li>
										        			</ul> 
										        			-->
															<div class="search-box">
																<input type="text" id="parkingSearchText" placeholder="주차장명/동을 입력하세요.">
																<button id="parkingSearch" class="search-btn"><spring:message code="payment.tab2.content20"/></button>
															</div>
															<div class="parking-scroll">
																<div class="parking-scroll-inner">
																	<!-- pc -->
																	<table class="parking-table pc">
																		<caption class="sr-only"><spring:message code="payment.tab2.content21"/></caption>
																		<colgruop>
																			<col style="width: 30%;" />
																			<col style="width: auto;" />
																		</colgruop>
																		<tbody id="pcParkingSearch">
																			<%-- <c:if test="${empty searchParkingList }">
													        					<td colspan="2">선택 가능한 주차장이 존재하지 않습니다.</td>
													        				</c:if>
													        				<c:forEach items="${searchParkingList}" var="searchParkingList">
														        				<tr class="parkingTr" data-sectnid="${searchParkingList.sectnId }">
														        					<th scope="col">
														        						<span class="parkingDivNm">[${searchParkingList.parkingDivNm }]</span>
														        						<a href="#;" class="parkingNm">${searchParkingList.parkingNm }</a>
														        					</th>
														        					<c:choose>
															        					<c:when test="${searchParkingList.sectnId eq 10 or searchParkingList.sectnId eq 101}">
															        						<td scope="col" class="all_parking select_parking">
															        					</c:when>
															        					<c:otherwise>
															        						<td scope="col" class="all_parking">
															        					</c:otherwise>
														        					</c:choose>
														        						<ul>
														        							<li><b class="parkingAmt">${searchParkingList.parkingNormalAmt } ${searchParkingList.parkingAddAmt },</b></li>
														        							<li class="parkingTm">${searchParkingList.parkingWdaysUseTm } ${searchParkingList.parkingWendUseTm }</li>
														        						</ul>
														        						<div>
														        							<input type="button" value="추가" class="parkingMap" data-lat="${searchParkingList.lat}" data-lng="${searchParkingList.lng}" data-dtlbldgnm="${searchParkingList.dtlBldgNm }"/>
														        						</div>
														        					</td>
														        				</tr>
													        				</c:forEach> --%>
													        			</tbody>
													        		</table>
													        		<!-- mobile -->
													        		<div id="mobileParkingSearch">
														        		<table class="parking-table mobile" id="mobileParking">
														        			<caption class="sr-only"><spring:message code="payment.tab2.content22"/></caption>
														        			<colgroup>
														        				<col style="width:100%;" />
														        			</colgroup>
														        			<thead>
														        				<tr>
														        					<th><spring:message code="payment.tab2.content23"/></th>
														        				</tr>
														        			</thead>
														        			<tbody>
														        				<tr>
														        					<td>
														        						<div>
														        							<input type="button" value="추가"/>
														        						</div>
														        					</td>
														        				<tr>
						
														        			</tbody>
														        		</table>
													        		</div>
												        		</div>
											        		</div>
										        		</article>
													</div>
													<div class="btn-row">
														<a href="javascript:void(0)" class="popup-one-btn" id="parkingSearchCancel"><spring:message code="payment.tab2.content25"/></a>
													</div>
										        </div>
										    </div>
										</div>
									</article>
									<article class="service-apply">
										<h2 class="subheading">개인정보 수집, 제공 및 활용 동의</h2>
										<div class="con_txt">
											
											<!-- <div class="agree_wrap">
											
												<p class="agree_tit">개인정보 수집·이용에 동의 하십니까?  </p>
												
												<div class="agree_box">
													<dl class="apply-list">
														<dt class="apply-title">[제1조] 개인정보의 처리목적, 개인정보의 처리 및 보유기간, 처리하는 개인정보의 항목</dt>
														<dd class="apply-cont">
															<ol>
																<li>① 부천시는 개인정보파일 목록에 게재된 목적을 위하여 개인정보를 처리합니다. 처리하고 있는 개인정보는 목적이외의 용도로는 이용되지 않으며, 이용 목적이 변경되는 경우에는 개인정보 보호법 제18조에 따라 별도의 동의를 받는 등 필요한 조치를 이행할 예정입니다.</li>
																<li>② 부천시는 법령에 따른 개인정보 보유&middot;이용기간 또는 정보주체로 부터 개인정보를 수집 시에 동의 받은 개인정보 보유&middot;이용기간 내에서 개인정보를 처리&middot;보유합니다.</li>
																<li>③ 부천시가 개인정보보호법 제32조에 따라 등록, 공개하는 개인정보 파일과 영상정보처리기기의 설치목적 및 장소 등을 다음의 목록에서 안내하고 있습니다.</li>
															</ol>
															<ul>
																<li><a href="http://www.privacy.go.kr/wcp/dcl/per/personalInfoFileList.do?searchInsttCode=3860000" target="_blank" title="새창으로 열림">부천시 개인정보파일 목록</a></li>
																<li><a href="http://www.bucheon.go.kr/site/inc/file/fileDownload?dirname=/148&amp;filename=%EB%B6%80%EC%B2%9C%EC%8B%9C%20%EC%98%81%EC%83%81%EC%A0%95%EB%B3%B4%EC%B2%98%EB%A6%AC%EA%B8%B0%EA%B8%B0%20%EC%84%A4%EC%B9%98%EC%9A%B4%EC%98%81%20%ED%98%84%ED%99%A9%20%282018%EB%85%84%29.xls" title="다운로드">부천시 영상정보처리기기 운영관리 방침 및 목록</a></li>
															</ul>
														</dd>
														<dt class="apply-title"><strong>[제2조]</strong> 개인정보의 제3자 제공</dt>
														<dd class="apply-cont">
															<ul>
																<li>
																	① 부천시는 정보주체의 개인정보를 제1조에서 명시한 범위 내에서만 처리하며, 다음의 경우를 제외하고는 정보주체의 사전 동의 없이는 본래의 목적 범위를 초과하여 처리하거나 제3자에게 제공하지 않습니다.
																	<ul>
																		<li>1. 정보주체로부터 별도의 동의를 받은 경우</li>
																		<li>2. 다른 법률에 특별한 규정이 있는 경우</li>
																		<li>3. 정보주체 또는 그 법정 대리인이 의사표시를 할 수 없는 상태에 있거나 주소불명 등으로 사전 동의를 받을 수 없는 경우로서 명백히 정보주체 또는 제3자의 급박한 생명,신체, 재산의 이익을 위하여 필요하다고 인정되는 경우</li>
																		<li>4. 통계작성 및 학술연구 등의 목적을 위하여 필요한 경우로서 특정 개인을 알아볼 수 없는 형태로 개인정보를 제공하는 경우</li>
																		<li>5. 개인정보를 목적 외의 용도로 이용하거나 이를 제3자에게 제공 하지 아니하면 다른 법률에서 정하는 소관 업무를 수행할 수 없는 경우로서 보호위원회의 심의&middot;의결을 거친 경우</li>
																		<li>6. 조약, 그 밖의 국제협정의 이행을 위하여 외국정부 또는국제기구에 제공하기 위하여 필요한 경우</li>
																		<li>7. 범죄의 수사와 공소의 제기 및 유지를 위하여 필요한 경우</li>
																		<li>8. 법원의 재판업무 수행을 위하여 필요한 경우</li>
																		<li>9. 형(刑) 및 감호, 보호처분의 집행을 위하여 필요한 경우</li>
																	</ul>
																</li>
																<li>② 부천시는 다음과 같이 개인정보를 제3자에게 제공하고 있습니다.</li>
															</ul>
					
															<ul class="ui1201-link">
																<li><a href="/site/program/board/basicboard/list?boardtypeid=27124&amp;menuid=148003005008">부천시 개인정보 제3자 제공 목록</a></li>
															</ul>
														</dd>
					
														<dt class="apply-title"><strong>[제3조]</strong> 개인정보처리의 위탁</dt>
														<dd class="apply-cont">
															<ul>
																<li>① 부천시는 원활한 개인정보 업무처리를 위하여 다음과 같이 개인정보 처리업무를 위탁하고 있습니다.</li>
															</ul>
															<ul class="ui1201-link">
																<li><a href="/site/program/board/basicboard/list?boardtypeid=27126&amp;menuid=148003005009">부천시 개인정보처리의 위탁 목록</a></li>
															</ul>
															<ul>
																<li>② 부천시는 위탁계약 체결시 개인정보 보호법 제25조에 따라 위탁업무 수행목적 외 개인정보 처리금지, 기술적&middot;관리적 보호조치, 재위탁 제한, 수탁자에 대한 관리&middot;감독, 손해배상책임 등에 관한사항을 계약서 등 문서에 명시하고, 수탁자가 개인정보를 안전하게 처리하는지를 감독하고 있습니다. 위탁업무의 내용이나 수탁자가 변경 될 경우에는 지체 없이 본 개인정보 처리방침을 통하여 공개하도록 하겠습니다.</li>
															</ul>
														</dd>
														<dt class="apply-title"><strong>[제4조]</strong> 인터넷 접속정보파일 등 개인정보의 자동 수집 장치의 설치&middot;운영 및 그 거부에 관한 사항</dt>
														<dd class="apply-cont">
															<ul>
																<li>부천시는 이용자에게 특화된 맞춤서비스를 제공하기 위해서 이용자들의 정보를 수시로 저장하고 불러오는 &#39;쿠키(cookie)&#39;를 운용합니다. 쿠키란 웹사이트를 운영하는데 이용되는 서버가 이용자의 브라우저에 보내는 아주 작은 텍스트 파일로서 이용자의 컴퓨터 하드디스크에 저장됩니다.</li>
																<li class="m-top10 no-bg-li">
																	1. 쿠키의 사용 목적<br/>
																		회원과 비회원의 접속 빈도나 방문 시간 등을 분석, 이용자의 취향과 관심분야를 파악 및 자취 추적, 각종 이벤트 참여 정도 및 방문 회수 파악 등을 통한 개인 맞춤 서비스 제공 이용자는 쿠키 설치에 대한 선택권을 가지고 있습니다. 따라서, 이용자는 웹브라우저에서 옵션을 설정함으로써 모든 쿠키를 허용하거나, 쿠키가 저장될 때마다 확인을 거치거나, 아니면 모든 쿠키의 저장을 거부할 수도 있습니다.
																</li>
																<li>
																	2. 쿠키 설정 거부 방법<br/>
																		쿠키 설정을 거부하는 방법으로는 이용자가 사용하는 웹 브라우저의 옵션을 선택함으로써 모든 쿠키를 허용하거나 쿠키를 저장할 때마다 확인을 거치거나, 모든 쿠키의 저장을 거부할 수 있습니다. 단, 쿠키 설치를 거부하였을 경우 로그인이 필요한 일부 서비스 이용에 어려움이 있을 수 있습니다.
																</li>
																<li>설정방법 예(인터넷 익스플로어의 경우) : 웹 브라우저 상단의 도구 &gt; 인터넷 옵션 &gt; 개인정보</li>
															</ul>
														</dd>
														<dt class="apply-title"><strong>[제5조]</strong> 개인정보 열람, 정정ㆍ삭제, 처리정지 요구권등 정보주체의 권리ㆍ의무 및 그 행사방법</dt>
														<dd class="apply-cont">
															<ul>
																<li>
																	① 정보주체는 부천시에서 보유하고 있는 개인정보에 대하여 개인정보보호법 제35조 및 제36조, 제37조에 따른 개인정보 열람 정정ㆍ삭제 처리정지 요구를 아래 부서 또는 행정안전부의 &lsquo;개인정보보호 종합지원 포털(<a href="https://www.privacy.go.kr/" target="_blank" title="새창">www.privacy.go.kr</a>)를 통하여 요구할 수 있습니다.
																	<ul>
																		<li>담당부서 : 정보통신과</li>
																		<li>신청방법 : 서면, 전화(032-625-2373) / FAX(032-625-8300)</li>
																		<li>
																			<p>처리절차</p>
																			<img alt="표" src="http://www.bucheon.go.kr/files/web148/images/sub/rescue_info1.gif" />
																		</li>
																		<li><a class="ui1201-btn" href="http://www.bucheon.go.kr/site/inc/file/fileDownload?dirname=/001&amp;filename=%EA%B0%9C%EC%9D%B8%EC%A0%95%EB%B3%B4+%EC%97%B4%EB%9E%8C+%EC%84%9C%EC%8B%9D+%EB%AA%A8%EC%9D%8C.hwp" title="다운로드">개인정보 열람, 정정, 삭제, 처리정지 관련 서식</a></li>
																	</ul>
																</li>
																<li>
																	② 제1항의 개인정보 열람 요구에 대하여 개인정보보호법 제35조 4항에 의하여 다음 각 호의 경우에 열람이 제한 될 수 있습니다.
																	<ul>
																		<li>1. 법률에 따라 열람이 금지되거나 제한되는 경우</li>
																		<li>2. 다른 사람의 생명&middot;신체를 해할 우려가 있거나 다른 사람의 재산과 그 밖의 이익을 부당하게 침해 할 우려가 있는 경우</li>
																		<li>3. 공공기관이 다음 각 목의 어느 하나에 해당하는 업무를 수행할 때 중대한 지장을 초래하는 경우 조세의 부과&middot;징수 또는 환급에 관한 업무「초&middot;중등교육법」 및 「고등교육법」에 따른 각급학교, 「평생교육법」에 따른 평생교육시설, 그 밖의 다른 법률에 따라 설치된 고등교육기관에서의 성적 평가 또는 입학자 선발에 관한 업무 학력&middot;기능 및 채용에 관한 시험, 자격 심사에 관한 업무</li>
																		<li>4. 보상금&middot;급부금 산정 등에 대하여 진행 중인 평가 또는 판단에 관한 업무</li>
																		<li>5. 다른 법률에 따라 진행 중인 감사 및 조사에 관한 업무</li>
																	</ul>
																</li>
																<li>③ 제1항의 개인정보 정정 삭제 요구에 대하여 다른 법령에서 그 개인정보가 수집 대상으로 명시되어 있는 경우에는 그 삭제를 요구할 수 없습니다.</li>
																<li>
																	④ 제1항의 개인정보 처리정지 요구에 대하여 개인정보보호법 제37조 2항에 의하여 다음 각 호의 경우에 처리정지 요구가 거절될 수 있습니다.
																	<ul>
																		<li>1. 법률에 특별한 규정이 있거나 법령상 의무를 준수하기 위하여 불가피한 경우</li>
																		<li>2. 다른 사람의 생명&middot;신체를 해할 우려가 있거나 다른 사람의 재산과 그 밖의 이익을 부당하게 침해할 우려가 있는 경우</li>
																		<li>3. 공공기관이 개인정보를 처리하지 아니하면 다른 법률에서 정하는 소관 업무를 수행할 수 없는 경우</li>
																		<li>4. 개인정보를 처리하지 아니하면 정보주체와 약정한 서비스를 제공하지 못하는 등 계약의 이행이 곤란한 경우로서 정보주체가 그 계약의 해지 의사를 명확하게 밝히지 아니한 경우</li>
																	</ul>
																</li>
																<li>⑤ 제1항에 따른 권리 행사는 정보주체의 법정대리인이나 위임을 받은 자 등 대리인을 통하여 하실 수 있습니다. 이 경우 개인정보 보호법 시행규칙 별지 제11호 서식에 따른 위임장을 제출하셔야 합니다. <a class="ui1201-btn" href="http://www.bucheon.go.kr/site/inc/file/fileDownload?dirname=001/&amp;filename=%EC%9C%84%EC%9E%84%EC%9E%A5.hwp" title="위임장">위임장</a></li>
																<li>⑥ 정보주체께서는 개인정보 열람 등의 요구에 대해 거절 등 처리결과에 불복할 경우 정보통신과(전화 032-625-2373)로 이의를 제기하실 수 있으며, 신청하신 이의에 대하여 10일 이내에 처리결과를 알려드리겠습니다.</li>
															</ul>
														</dd>
														<dt class="apply-title"><strong>[제6조]</strong> 개인정보의 파기</dt>
														<dd class="apply-cont">
															<ul>
																<li>
																	① 부천시는 원칙적으로 개인정보 처리목적이 달성된 개인정보는 지체 없이 파기합니다. 파기의 절차, 기한 및 방법은 다음과 같습니다.
																	<ul>
																		<li>
																			1. 파기절차 : 개인정보는 목적 달성 후 즉시 또는 별도의 공간에 옮겨져 내부방침 또는 기타 관련 법령에 따라 일정기간 저장된 후 파기됩니다.<br />
																				별도의 공간으로 옮겨진 개인정보는 법률에 의한 경우가 아니고서는 다른 목적으로 이용되지 않습니다.
																		</li>
																		<li>2. 파기 기한 : 보유기간이 만료되었거나 개인정보의 처리목적달성, 해당 업무의 폐지 등 그 개인정보가 불필요하게 되었을 때에는 지체 없이 파기합니다.</li>
																		<li>3. 파기방법 : 전자적 파일형태의 정보는 기록을 재생할 수 없는 기술적 방법을 사용합니다. 종이에 출력된 개인정보는 분쇄기로 분쇄하거나 소각을 통하여 파기합니다.</li>
																	</ul>
																</li>
															</ul>
														</dd>
														<dt class="apply-title"><strong>[제7조]</strong> 개인정보의 안정성 확보 조치</dt>
														<dd class="apply-cont">
															<ul>
																<li>부천시는 개인정보의 안전성 확보를 위하여 다음과 같은 안전 조치를 취하고 있습니다.</li>
																<li>1. 개인정보 취급직원의 최소화 및 교육</li>
																<li>개인정보를 취급하는 직원은 반드시 필요한 인원에 한하여 지정&middot;관리하고 있으며 취급직원을 대상으로 안전한 관리를 위한 교육을 실시하고 있습니다.</li>
																<li>2. 개인정보에 대한 접근 제한</li>
																<li>개인정보를 처리하는 데이터베이스시스템에 대한 접근권한의 부여&middot;변경&middot;말소를 통하여 개인정보에 대한 접근통제를 위한 필요한 조치를 하고 있으며 침입차단시스템을 이용하여 외부로부터의 무단 접근을 통제하고 있습니다.</li>
																<li>3. 접속기록의 보관</li>
																<li>개인정보처리시스템에 접속한 기록(웹 로그, 요약정보 등)을 최소 6개월이상 보관&middot;관리하고 있습니다.</li>
																<li>4. 개인정보의 암호화</li>
																<li>개인정보는 암호화 등을 통해 안전하게 저장 및 관리되고 있습니다. 또한 중요한 데이터는 저장 및 전송 시 암호화하여 사용하는 등의 별도 보안기능을 사용하고 있습니다.</li>
																<li>5. 보안프로그램 설치 및 주기적 점검&middot;갱신</li>
																<li>해킹이나 컴퓨터 바이러스 등에의한 개인정보 유출 및 훼손을 막기 위하여 보안프로그램을 설치하고 주기적으로 갱신&middot;점검하고 있습니다.</li>
																<li>6. 비인가자에 대한 출입 통제</li>
																<li>개인정보를 보관하고 있는 개인정보시스템의 물리적 보관장소를 별도로 두고 이에 대해 출입통제 절차를 수립, 운영하고 있습니다.</li>
															</ul>
														</dd>
														<dt class="apply-title"><strong>[제8조]</strong> 권익침해 구제 방법</dt>
														<dd class="apply-cont">
															<ul>
																<li>
																	정보주체는 아래의 기관에 대해 개인정보 침해에 대하여 피해구제, 상담 등을 문의하실 수 있습니다.<br/>
																	「아래의 기관은 부천시와는 별개의 기관으로서, 부천시의 자체적인 개인정보 불만 처리, 피해구제 결과에 만족하지 못하시거나 보다 자세한 도움이 필요하시면 문의하여 주시기 바랍니다.」
																</li>
																<li>
																	개인정보보호 종합포털
																	<ul>
																		<li>소관업무 : 개인정보 침해사실 신고, 상담신청, 자료제공</li>
																		<li>홈페이지 : <a href="https://www.privacy.go.kr/" target="_blank" title="새창">www.privacy.go.kr</a></li>
																		<li>전화: 02-2100-3394</li>
																	</ul>
																</li>
																<li>
																	개인정보 침해신고센터(한국인터넷진흥원 운영)
																	<ul>
																		<li>소관업무 : 개인정보 침해사실 신고, 상담신청</li>
																		<li>홈페이지 : <a href="http://privacy.kisa.or.kr/kor/main.jsp" target="_blank" title="새창">privacy.kisa.or.kr</a></li>
																		<li>전화: (국번없이) 118</li>
																		<li>주소 : (138-950) 서울시 송파구 중대로135 한국인터넷진흥원 개인정보침해신고센터</li>
																	</ul>
																</li>
																<li>
																	개인정보 보호위원회
																	<ul>
																		<li>소관업무 : 개인정보분쟁조정신청, 집단분쟁조정 (민사적 해결)</li>
																		<li>홈페이지 : <a href="https://www.kopico.go.kr/main/main.do" target="_blank" title="새창">www.kopico.go.kr</a></li>
																		<li>전화: 02-2100-2499</li>
																		<li>주소 : (03171) 서울특별시 종로구 세종대로 209 정부서울청사 4층</li>
																	</ul>
																</li>
																<li>
																	경찰청 사이버테러 대응센터
																	<ul>
																		<li>소관업무 : 개인정보 침해 관련 형사사건 문의 및 신고</li>
																		<li>홈페이지: <a href="http://cyberbureau.police.go.kr/" target="_blank" title="새창">cyberbureau.police.go.kr</a></li>
																		<li>전화 :(사이버범죄)02-393-9112, (경찰청 대표) 1566-0112</li>
																	</ul>
																</li>
															</ul>
														</dd>
														<dt class="apply-title"><strong>[제9조]</strong> 개인정보 보호책임자 및 담당부서</dt>
														<dd class="apply-cont">
															<ul>
																<li>① 부천시는 개인정보 처리에 관한 업무를 총괄해서 책임지고 개인정보처리와 관련한 정보주체의 불만처리 및 피해구제 등을 위하여 아래와 같이 개인정보 보호책임자와 담당부서를 지정하고 있습니다.</li>
																<li>
																	개인정보 보호책임자
						                                            <ul>
						                                                <li>성 명 : 정해웅</li>
						                                                <li>직 책 : 행정국장</li>
						                                                <li>연락처 : 032-625-2020</li>
						                                            </ul>
						                                        </li>
						                                        <li>
																	개인정보 보호 담당부서
						                                            <ul>
						                                                <li>부서명 : 정보통신과</li>
						                                                <li>담당자 : 황준연</li>
						                                                <li>연락처: 032-625-2373</li>
						                                            </ul>
																</li>
																<li>② 정보주체께서는 부천시의 서비스(또는 사업)를 이용하시면서 발생한 모든 개인정보 보호 관련 문의, 불만처리, 피해구제 등에 관한 사항을 개인정보 보호책임자 및 담당부서로 문의하실 수 있습니다. 부천시는 정보주체의 문의에 대해 지체 없이 답변 및 처리해드릴 것입니다.</li>
															</ul>
														</dd>
														<dt class="apply-title"><strong>[제10조]</strong> 개인정보 처리방침 변경</dt>
														<dd class="apply-cont">
															<ul>
																<li>
																	이 개인정보 처리방침은 개인정보보호법 및 표준 개인정보보호 지침에 따라 기존 &#39;부천시 개인정보보호방침&#39;에서 용어, 기재항목, 내용을 변경하여 수립, 공개합니다.<br/>
																	이 개인정보처리방침은 게시일로부터 적용됩니다.<br/>
																	이전의 개인정보처리방침은 아래에서 확인하실 수 있습니다.
																	<ul>
																		<li>2017. 2. 8 ~ 2018. 2. 8 적용 <a href="http://www.bucheon.go.kr/site/inc/file/fileDownload?dirname=/001&amp;filename=2018.%202.%208%20%EC%A0%81%EC%9A%A9%20(%EA%B0%9C%EC%9D%B8%EC%A0%95%EB%B3%B4%EB%B3%B4%ED%98%B8%EB%B0%A9%EC%B9%A8(%EA%B5%AC).hwp" title="다운로드">(개인정보보호방침(구))</a></li>
																		<li>2012. 2. 1 ~ 2017. 2. 7 적용 <a href="http://www.bucheon.go.kr/site/inc/file/fileDownload?dirname=001/&amp;filename=2016%EB%85%84%20%EA%B0%9C%EC%9D%B8%EC%A0%95%EB%B3%B4%EB%B3%B4%ED%98%B8%EB%B0%A9%EC%B9%A8%28%EA%B5%AC%29.hwp" title="다운로드">(개인정보보호방침(구))</a></li>
																		<li>2011. 9. 23 ~ 2012. 1. 31 적용 <a href="http://www.bucheon.go.kr/site/inc/file/fileDownload?dirname=001/&amp;filename=2011%EB%85%84%20%EA%B0%9C%EC%9D%B8%EC%A0%95%EB%B3%B4%EB%B3%B4%ED%98%B8%EB%B0%A9%EC%B9%A8%28%EA%B5%AC%29.hwp" title="다운로드">(개인정보보호방침(구))</a></li>
																		<li>2009. 7. 27~2011. 9. 22 적용 <a href="http://www.bucheon.go.kr/site/inc/file/fileDownload?dirname=001/&amp;filename=2009%EB%85%84%20%EA%B0%9C%EC%9D%B8%EC%A0%95%EB%B3%B4%EB%B3%B4%ED%98%B8%EB%B0%A9%EC%B9%A8%28%EA%B5%AC%29.hwp" title="다운로드">(개인정보보호방침(구))</a></li>
																	</ul>
																</li>
															</ul>
														</dd>
													</dl>
												</div> -->
												<div class="rule-box mt20">
													<ol>
														<li>
															<h2><spring:message code="nonstop.tab2.content26"/></h2>
															<ul>
																<li><spring:message code="nonstop.tab2.content27"/></li>
																<li><spring:message code="nonstop.tab2.content28"/></li>
																<li><spring:message code="nonstop.tab2.content29"/></li>
																<li>
																	<table>
																		<thead>
																			<tr>
																				<th rowspan="2"><spring:message code="nonstop.tab2.content30"/></th>
																				<th colspan="2"><spring:message code="nonstop.tab2.content31"/></th>
																				<th rowspan="2"><spring:message code="nonstop.tab2.content32"/></th>
			                             									</tr>
			                             									<tr>
																			 	<th><spring:message code="nonstop.tab2.content33"/></th>
																				<th><spring:message code="nonstop.tab2.content34"/></th>
																			</tr>
																		</thead>
			                             								<tbody>
																			<tr>
																				<td><spring:message code="nonstop.tab2.content35"/></td>
																				<td><spring:message code="nonstop.tab2.content36"/></td>
																				<td><spring:message code="nonstop.tab2.content37"/></td>
																				<td><spring:message code="nonstop.tab2.content38"/></td>
																			</tr>
																		</tbody>
																	</table>
																</li>
																<li><spring:message code="nonstop.tab2.content39"/></li>
																<li><spring:message code="nonstop.tab2.content40"/></li>
																<li><spring:message code="nonstop.tab2.content41"/></li>
																<li>
																	<h2>
																		<spring:message code="nonstop.tab2.content42"/> 
																		<spring:message code="nonstop.tab2.content43"/> 
																		<spring:message code="nonstop.tab2.content44"/>
																	</h2>
																</li>
																<li>
																	<table>
																		<thead>
																			<tr>
																				<th><spring:message code="nonstop.tab2.content45"/></th>
																				<th><spring:message code="nonstop.tab2.content46"/></th>
																			</tr>
																		</thead>
																		<tbody>	
																			<tr>
																				<td><spring:message code="nonstop.tab2.content47"/></td>
																				<td> 
																					<ul>
																						<li class="cont"><spring:message code="nonstop.tab2.content48"/></li>
																						<li class="cont"><spring:message code="nonstop.tab2.content49"/></li>
																						<li class="cont"><spring:message code="nonstop.tab2.content50"/></li>
																					</ul> 
																				</td>
																			</tr>
																		</tbody>
																	</table>
																</li>
																<li><spring:message code="nonstop.tab2.content51"/></li>
																<li>
																	<h2><spring:message code="nonstop.tab2.content52"/></h2>
																</li>
																<li>
																	<h2>
																		<spring:message code="nonstop.tab2.content53"/> 
																		<spring:message code="nonstop.tab2.content54"/>
																	</h2>
																</li>
															</ul>
														</li>
													</ol>
												</div>
												<p class="chk_agree">
													<input type="checkbox" class="hlabel" id="privacyChk" />
													<label for="privacyChk">개인정보 수집 및 이용안내를 동의하였습니다.</label>
												</p>
												<!-- <p id="agreeTxt" class="chk_alert _hide">개인정보 수집 및 이용안내 숙지를 체크하여 주십시오.</p> -->
											</div>
											
											<!-- btn -->
											<div class="btn-row">
												<ul class="btn-list">
													<li class="two-btn"><a href="javascript:void(0);" id="btn_serviceapply" class="btn-type1 service-apply" ><spring:message code="payment.tab2.content24"/></a></li>
													<li class="two-btn"><a href="javascript:fCallUrl('111101','111001','/payment/select_payment_guide.do')" class="btn-type2 apply-cancel"><spring:message code="payment.tab2.content25"/></a></li>
												</ul>
											</div>
											<!-- 											
											<ul class="btn-list">
												<li class="btn">
													<a href="javascript:void(0);" id="btn_serviceapply" class="btn-type1 service-apply" >서비스 신청</a>
												</li>
												<li class="btn">
													<a href="" class="btn-type2 apply-cancel">취소</a>
												</li>
											</ul>
											 -->
										</div>
										
										<div id="layer1" class="pop-layer">
										    <div class="pop-container">
										        <div class="pop-conts">
										        	<div class="pop-tit">
										        		<ul>
										        			<li><spring:message code="payment.tab2.content26"/></li>
										        			<li><a href="javascript:void(0);" class="icon-close btn-Close"></a></li>
										        		</ul>     		
										        	</div>
										        	
										        	<div class="pop-cont">
										        		<h3 id="applyPop1Text"><spring:message code="payment.tab2.content27"/></h3>
													</div>
													<div class="btn-row">
														<ul class="btn-list">
															<li class="two-btn"><a href="javascript:void(0);" id="btn_go_insert"><spring:message code="payment.tab2.content28"/></a></li>
															<li class="two-btn"><a href="javascript:void(0);" class="icon-close btn-Close"><spring:message code="payment.tab2.content29"/></a></li>
														</ul>
													</div>
										        </div>
										    </div>
										</div>
										<div id="layer2" class="pop-layer">
										    <div class="pop-container">
										        <div class="pop-conts">
										        	<div class="pop-tit">
										        		<ul>
										        			<li><spring:message code="payment.tab2.content30"/></li>
										        			<li><a href="javascript:void(0);" class="icon-close btn-Close"></a></li>
										        		</ul>
										        	</div>
										        	<div class="pop-cont">
										        		<h3 id="applyPop2Text"><spring:message code="payment.tab2.content31"/></h3>
													</div>
										        </div>
										        <div class="btn-row">
										            <ul class="btn-list">
														<li class="popup-one-btn">
															<a href="javascript:void(0);" id="btn_go_step3" class="btn-Close btn-type1"><spring:message code="payment.tab2.content32"/></a>
														</li>
													</ul>
												</div>
										    </div>
										</div>
										<div id="layer14" class="pop-layer">
										    <div class="pop-container">
										        <div class="pop-conts">
										        	<div class="pop-tit">
										        		<ul>
										        			<li><spring:message code="payment.tab2.content33"/></li>
										        			<li><a href="javascript:void(0);" class="icon-close btn-Close"></a></li>
										        		</ul>
										        	</div>
										        	<div class="pop-cont">
										        		<h3 id="applyPop14Text"><spring:message code="payment.tab2.content34"/></h3>
														<!-- 											            
														<ul class="btn-list">
															<li class="btn">
																<a href="javascript:void(0);" id="btn_go_step4" class="btn-Close btn-type1">확인</a>
															</li>
														</ul> 
														-->
													</div>
													<div class="btn-row">
											            <ul class="btn-list">
															<li class="popup-one-btn">
																<a href="javascript:void(0);" id="btn_go_step4" class="btn-Close btn-type1"><spring:message code="payment.tab2.content35"/></a>
															</li>
														</ul>
													</div>
										        </div>
										    </div>
										</div>
									</article>
								</section>
								<section id="tab3" class="tabcontent">
									<article>
											<div class="enrollment-info">
												<h2 class="subheading"><spring:message code="payment.tab3.content1"/></h2>
												<div class="one-btn-white">
													<a href="#cardLayer" id="cardAddBtn"><spring:message code="payment.tab3.content2"/></a>
												</div>
											</div>
										<div class="con_txt">
											<div class="table-info">
												<table class="list-pc">
													<caption class="sr-only"><spring:message code="payment.tab3.content3"/></caption>
													<colgroup>
														<col style="width:50%;">
														<col style="width:25%;">
														<col style="width:25%;">
													</colgroup>
													<thead>
														<tr>
															<th scope="col"><spring:message code="payment.tab3.content4"/></th>
															<th scope="col"><spring:message code="payment.tab3.content5"/></th>
															<th scope="col"><spring:message code="payment.tab3.content6"/></th>
														</tr>
													</thead>
													<tbody id="tb_card_list">
														<tr>
															<td colspan="3" style="text-align:center; padding-left:0px;"><spring:message code="payment.tab3.content7"/></td>
														</tr>
													</tbody>
												</table>
											
												<!-- mobile table -->
												<div id = "mobile_test">
													<table class="list-mobile">
														<caption class="sr-only"><spring:message code="payment.tab3.content8"/></caption>
														<colgroup>
															<col style="width:100%;">
														</colgroup>
														<thead>
															<tr>
																<th scope="col"><spring:message code="payment.tab3.content9"/></th> 
															</tr>
														</thead>
														<tbody>
															<tr>
																<td style="text-align:center; padding-left:0px;"><spring:message code="payment.tab3.content10"/></td>
															</tr>
														</tbody>
													</table>
												</div>
											</div>
											<p class="cont"><spring:message code="payment.tab3.content11"/></p>
											<!-- btn -->
											<div class="btn-row">
												<ul class="btn-list">
													<li class="two-btn"><a href="javascript:fCallUrl('111102','111002','/payment/select_payment_apply.do')" class="btn-type1" id=""><spring:message code="payment.tab3.content12"/></a></li>
													<li class="two-btn"><a href="javascript:fCallUrl('111104','111004','/payment/select_payment_car.do')" class="btn-type1" id=""><spring:message code="payment.tab3.content13"/></a></li>
												</ul>
											</div>
										</div>
										<div id="layer3" class="pop-layer">
										    <div class="pop-container">
										        <div class="pop-conts">
										        	<div class="pop-tit">
										        		<ul>
										        			<li><spring:message code="payment.tab3.content14"/></li>
										        			<li><a href="javascript:void(0);" class="icon-close btn-Close"></a></li>
										        		</ul>
										        	</div>
										        	<div class="pop-cont">
										        		<h3><spring:message code="payment.tab3.content15"/></h3>
													</div>
													<div class="btn-row">
														<ul class="btn-list">
															<li class="two-btn"><a href="#layer4" class="btn-type1" onclick="ajaxcard_edit()"><spring:message code="payment.tab3.content16"/></a></li>
															<li class="two-btn"><a href="javascript:void(0);" class="btn-type1"><spring:message code="payment.tab3.content17"/></a></li>
														</ul>
													</div>
										        </div>
										    </div>
										</div>
										<div id="cardLayer" class="pop-layer">
										    <div class="pop-container">
										        <div class="pop-conts">
										        	<div class="pop-tit">
										        		<ul>
										        			<li><spring:message code="payment.tab3.content18"/></li>
										        			<li><a href="#;" class="icon-close btn-Close"></a></li>
										        		</ul>     		
										        	</div>
										        	<div class="pop-cont">
										        		<div class="pop-multiple">
										        			<p><spring:message code="payment.tab3.content19"/></p>
										        			<p><spring:message code="payment.tab3.content20"/></p>
										        			<p><spring:message code="payment.tab3.content21"/></p>
										        		 </div>
													</div>
													<div class="btn-row">
											            <ul class="btn-list">
															<li class="two-btn"><a href="#layer2" id="cardAdd"><spring:message code="payment.tab3.content22"/></a></li>
															<li class="two-btn"><a href="javascript:void(0);" class="icon-close btn-Close"><spring:message code="payment.tab3.content23"/></a></li>
														</ul>
													</div>
										        </div>
										    </div>
										</div>
										<div id="layer4" class="pop-layer">
										    <div class="pop-container">
										        <div class="pop-conts">
										        	<div class="pop-tit">
										        		<ul>
										        			<li><spring:message code="payment.tab3.content24"/></li>
										        			<li><a href="javascript:void(0);" class="icon-close btn-Close"></a></li>
										        		</ul>
										        	</div>
										        	<div class="pop-cont">
										        		<h3><spring:message code="payment.tab3.content25"/></h3>
													</div>
													<div class="btn-row">
											            <ul class="btn-list">
															<li class="popup-one-btn"><a href="javascript:void(0);"><spring:message code="payment.tab3.content26"/></a></li>
														</ul>
													</div>
										        </div>
										    </div>
										</div>
									</article>
								</section>
								<section id="tab4" class="tabcontent">
									<article class="parking-information">
										<h2 class="subheading"><spring:message code="payment.tab4.content1"/></h2>
										<div>
											<div class="cont_board">
												<table class="one-table">
													<caption class="sr-only"><spring:message code="payment.tab4.content2"/></caption>
													<colgroup>
														<col style="width: 25%;">
														<col style="width: 75%;">
													</colgroup>
													<tbody>
														<tr>
															<th><spring:message code="payment.tab4.content3"/></th>
															<td>
																<div class="form-btn-box">
																	<ul>
																		<li>
																			<input type="text" id="carNo" class="onlynum" maxlength="4">
																		</li>
																		<li><spring:message code="payment.tab4.content4"/></li>
																		<li class="lookup-btn"><a href="javascript:void(0);" id="carinlist" class="btn-type1"><spring:message code="payment.tab4.content5"/></a></li>
																	</ul>
																</div>
															</td>
														</tr>
													</tbody>
												</table>
											</div>
											<div id="layer15" class="pop-layer">
											    <div class="pop-container">
											        <div class="pop-conts">
											        	<div class="pop-tit">
											        		<ul>
											        			<li><spring:message code="payment.tab4.content6"/></li>
											        			<li><a href="javascript:void(0);" class="icon-close btn-Close"></a></li>
											        		</ul>
											        	</div>
											        	<div class="pop-cont">
											        		<h3 id="applyPop15Text"><spring:message code="payment.tab4.content7"/></h3>
														</div>
														<div class="btn-row">
												            <ul class="btn-list">
																<li class="popup-one-btn"><a href="javascript:void(0);" id="btn_go_step4"><spring:message code="payment.tab4.content8"/></a></li>
															</ul>
														</div>
												    </div>
												</div>
											</div>
											<div>
												<!-- pc table -->
												<table class="list-pc">
													<caption class="sr-only"><spring:message code="payment.tab4.content9"/></caption>
													<colgroup>
														<col style="width:25%;">
														<col style="width:20%;">
														<col style="width:25%;">
														<col style="width:5%;">
														<col style="width:10%;">
														<col style="width:15%;">
													</colgroup>
													<thead>
														<tr>
															<th scope="col"><spring:message code="payment.tab4.content10"/></th>
															<th scope="col"><spring:message code="payment.tab4.content11"/></th>
															<th scope="col"><spring:message code="payment.tab4.content12"/></th>
															<th scope="col"><spring:message code="payment.tab4.content13"/></th>
															<th scope="col"><spring:message code="payment.tab4.content14"/></th>
															<th scope="col"><spring:message code="payment.tab4.content15"/></th>
														</tr>
													</thead>
													<tbody id="carintable">
														<tr>
															<td colspan="6"><spring:message code="payment.tab4.content16"/></td>
														</tr>
													</tbody>
												</table>
												<!-- mobile table -->
												<div id="carintableMoblie">
													<table class="list ver_list list-mobile">
														<caption class="sr-only"><spring:message code="payment.tab4.content17"/></caption>
														<colgroup>
															<col style="width:100%;">
														</colgroup>
														<thead>
															<tr>
																<th scope="col"><spring:message code="payment.tab4.content18"/></th>
															</tr>
														</thead>
														<tbody>
															<tr>
																<td colspan="2"><spring:message code="payment.tab4.content19"/></td>
															</tr>
														</tbody>
													</table>
												</div>
											</div>
										</div>
										<ul>
											<li class="explanation"><p><spring:message code="payment.tab4.content20"/></p></li>
										</ul>
									</article>
									<article class="information-payment hide">
										<h2 class="subheading"><spring:message code="payment.tab4.content21"/></h2>
										<div>
											<div class="cont_board">
												<table class="contable">
													<caption class="sr-only"><spring:message code="payment.tab4.content22"/></caption>
													<colgroup>
														<col style="width:20%;">
														<col style="width:80%;">
													</colgroup>
													<tbody>
														<tr>
															<th><spring:message code="payment.tab4.content23"/></th>
															<td>
																<ul class="carnumber">
																	<li><span></span></li>
																	<li class="normal-border-btn"><span><a href="javascript:void(0);" id="paybtn"><spring:message code="payment.tab4.content24"/></a></span></li>
																	<li class="normal-border-btn"><span><a href="#layer11" id="baseSet" ><spring:message code="payment.tab4.content25"/></a></span></li>
																</ul>
															</td>
														</tr>
														<tr>
															<th><spring:message code="payment.tab4.content26"/></th>
															<td>
																<ul class="payment-division">
																	<li data-tab="division-tab1" id="baseTm" class="normal-btn checked"><spring:message code="payment.tab4.content27"/></li>
																	<li data-tab="division-tab2" id="baseAmt" class="normal-btn"><spring:message code="payment.tab4.content28"/></li>
																	<li data-tab="division-tab3" id="baseAllAmt" class="normal-btn"><spring:message code="payment.tab4.content29"/></li>
																</ul>
															</td>
														</tr>
														<tr>
															<th><spring:message code="payment.tab4.content30"/></th>
															<td>
																<input type="hidden" id="accNumTm" value="0" />
																<input type="hidden" id="accNumAmt" value="0" />
																<input type="hidden" id="accNumAllAmt" value="0" />
																<input type="hidden" id="accNumMaxTm" value="0" />
																<input type="hidden" id="accNumMaxAmt" value="0" />
																<input type="hidden" id="carlistindex" value="0" />
																<div id="division-tab1" class="division-content on">
																	<ul>
																		<li><input type='button' class="btn btn-default btn_num" value='+ 10(분)' ></li>
																		<li><input type='button' class="btn btn-default btn_num" value='+ 30(분)' ></li>
																		<li><input type='button' class="btn btn-default btn_num" value='+ 60(분)' ></li>
																	</ul>
																	<p><input type="text" id="baseTmResult" class="onlynum"><spring:message code="payment.tab4.content31"/></p>
																</div>
																<div id="division-tab2" class="division-content">
																	<ul>
																		<li class="prepayment-btn"><input type='button' class="btn btn-default btn_num" value='+ 50(원)' ></li>
																		<li class="prepayment-btn"><input type='button' class="btn btn-default btn_num" value='+ 100(원)' ></li>
																		<li class="prepayment-btn"><input type='button' class="btn btn-default btn_num" value='+ 500(원)' ></li>
																		<li class="prepayment-btn"><input type='button' class="btn btn-default btn_num" value='+ 1000(원)' ></li>
																	</ul>
																	<p><input type="text" id="baseAmtResult" class="onlynum"><spring:message code="payment.tab4.content32"/></p>
																</div>
																<div id="division-tab3" class="division-content">
																	<p><input type="text" id="baseAllAmtResult" class="sum" readonly="readonly"><spring:message code="payment.tab4.content33"/></p>
																</div>
															</td>
														</tr>
													</tbody>
												</table>
											</div>
											<ul class="block">
												<li class="explanation"><spring:message code="payment.tab4.content33"/></li>
												<li class="explanation"><spring:message code="payment.tab4.content34"/></li>
											</ul>
										</div>
										<div id="layer7" class="pop-layer">
										    <div class="pop-container">
										        <div class="pop-conts">
										        	<div class="pop-tit">
										        		<ul>
										        			<li><spring:message code="payment.tab4.content35"/></li>
										        			<li><a href="javascript:void(0);" class="icon-close btn-Close"></a></li>
										        		</ul>
										        	</div>
										        	<div class="pop-cont">
										        		<h3><spring:message code="payment.tab4.content36"/></h3>
													</div>
													<div class="btn-row">
											            <ul class="btn-list">
															<li class="two-btn">
																<a href="javascript:void(0);" id="receipt_add" class="btn-type1"><spring:message code="payment.tab4.content37"/></a>
															</li>
															<li class="two-btn">
																<a href="javascript:void(0);" class="btn-layerClose btn-type2"><spring:message code="payment.tab4.content38"/></a>
															</li>
														</ul>
													</div>
										        </div>
										    </div>
										</div>
										<div id="layer8" class="pop-layer">
										    <div class="pop-container">
										        <div class="pop-conts">
										        	<div class="pop-tit">
										        		<ul>
										        			<li><spring:message code="payment.tab4.content39"/></li>
										        			<li><a href="javascript:void(0);" class="icon-close btn-Close"></a></li>
										        		</ul>
										        	</div>
										        	<div class="pop-cont">
										        		<h3 id="applyPop8Text"></h3>
													</div>
													<div class="btn-row">
											            <ul class="btn-list">
															<li class="one-btn">
																<a href="javascript:void(0);" class="btn-Close btn-type1"><spring:message code="payment.tab4.content40"/></a>
															</li>
														</ul>
													</div>
										        </div>
										    </div>
										</div>
										
										<!--  수정  -->
										<div id="layer11" class="pop-layer">
										    <div class="pop-container">
										        <div class="pop-conts">
										        	<div class="pop-tit">
										        		<ul>
										        			<li><spring:message code="payment.tab4.content41"/></li>
										        			<li><a href="javascript:void(0);" class="icon-close btn-Close"></a></li>
										        		</ul>
										        	</div>
										        	<div class="pop-cont">
											        	<div class="cont_board custom_cont_board">
															<table class="contable">
																<caption class="sr-only"><spring:message code="payment.tab4.content42"/></caption>
																<colgroup>
																	<col style="width:20%;">
																	<col style="width:80%;">
																</colgroup>
																<tbody>
																	<tr>
																		<th><spring:message code="payment.tab4.content43"/></th>
																		<td>
																			<div class="payment-division">
																				<input type="radio" name="payment" value="time" id="payment-time" checked="true"><label for="payment-time"><spring:message code="payment.tab4.content44"/></label>
																				<input type="radio" name="payment" value="fee" id="payment-fee" checked="false"><label for="payment-fee"><spring:message code="payment.tab4.content45"/></label>
																				<input type="radio" name="payment" value="full" id="payment-full" checked="false"><label for="payment-full"><spring:message code="payment.tab4.content46"/></label>
																			</div>							
																		</td>
																	</tr>
																	<tr>
																		<th><spring:message code="payment.tab4.content47"/></th>
																		<td>
																			<input type="text" id="baseSetTm"><spring:message code="payment.tab4.content48"/>
																		</td>
																	</tr>
																	<tr>
																		<th><spring:message code="payment.tab4.content49"/></th>
																		<td>
																			<input type="text" id="baseSetAmt"><spring:message code="payment.tab4.content50"/>
																		</td>
																	</tr>
																</tbody>
															</table>
														</div>		     
													</div>
													<div class="btn-row">
											            <ul class="btn-list">
															<li class="two-btn"><a href="javascript:void(0);" id="btn_base"><spring:message code="payment.tab4.content51"/></a></li>
															<li class="two-btn"><a href="javascript:void(0);"><spring:message code="payment.tab4.content52"/></a></li>
														</ul>
													</div>
										        </div>
										    </div>
										</div>
										<div id="layer12" class="pop-layer">
										    <div class="pop-container">
										        <div class="pop-conts">
										        	<div class="pop-tit">
										        		<ul>
										        			<li><spring:message code="payment.tab4.content53"/></li>
										        			<li><a href="javascript:void(0);" class="icon-close btn-Close"></a></li>
										        		</ul>
										        	</div>
										        	<div class="pop-cont">
										        		<h3><spring:message code="payment.tab4.content54"/></h3>
<!-- 											            <ul class="btn-list">
															<li class="btn">
																<a href="javascript:void(0);" class="btn-Close btn-type1">확인</a>
															</li>
														</ul> -->
													</div>
													<div class="btn-row">
											            <ul class="btn-list">
															<li class="one-btn">
																<a href="javascript:void(0);" class="btn-Close btn-type1"><spring:message code="payment.tab4.content55"/></a>
															</li>
														</ul>
													</div>
										        </div>
										    </div>
										</div>
									</article>
									<div id="layer16" class="pop-layer">
									    <div class="pop-container">
									        <div class="pop-conts">
									        	<div class="pop-tit">
									        		<ul>
									        			<li><spring:message code="payment.tab4.content56"/></li>
									        			<li><a href="javascript:void(0);" class="icon-close btn-Close"></a></li>
									        		</ul>
									        	</div>
									        	<div class="pop-cont">
									        		<h3 id="carAddBody"><spring:message code="payment.tab4.content57"/></h3>
	<!-- 									            <ul class="btn-list">
														<li class="btn">
															<a href="javascript:void(0);" class="btn-Close2 btn-type1">확인</a>
														</li>
													</ul> -->
												</div>
												<div class="btn-row">
										            <ul class="btn-list">
														<li class="one-btn">
															<a href="javascript:void(0);" class="btn-Close2 btn-type1"><spring:message code="payment.tab4.content58"/></a>
														</li>
													</ul>
												</div>
									        </div>
									    </div>
									</div>
									<article class="delivery-vehicle">
										<h2 class="subheading"><spring:message code="payment.tab4.content59"/></h2>
										<div class="con_txt">
											<div class="table-info">
												<table class="one-table">
													<caption class="sr-only"><spring:message code="payment.tab4.content60"/></caption>
													<colgroup>
														<col style="width:15%;">
														<col style="width:35%;">
														<col style="width:15%;">
														<col style="width:35%;">
													</colgroup>
													<tbody>
														<tr>
															<th><spring:message code="payment.tab4.content61"/></th>
															<td>
																<div class="form-btn-box payment">
																	<ul class="calendar">
																		<li>
																			<input type="text"  id="regStartDt" value="${regStartDt }" readonly="readonly">
																		</li>
																		<li><span class="text-wave">~</span></li>
																		<li><input type="text" id="regEndDt" value="${regEndDt } " readonly="readonly"></li>
																	</ul>
																</div>
															</td>
															<th><spring:message code="payment.tab4.content62"/></th>
															<td>
																<div class="form-btn-box">
																	<ul class="car-number">
																		<li><input type="text" id="car-number_carNo" class="onlynum" maxlength="4"></li>
																		<li><spring:message code="payment.tab4.content63"/></li>
																		<li class="lookup-btn"><a href="javascript:void(0);" onclick="btn_carlist();"><spring:message code="payment.tab4.content64"/></a></li>
																	</ul>
																</div>
															</td>
														</tr>
													</tbody>
												</table>
											</div>
											<ul class="total">
												<li class="explanation" id="totalPay"><spring:message code="payment.tab4.content65"/></li>
											</ul>
											<div class="cont_board info pay-ment-board overflow_table">
												<!-- pc table -->
												<table class="list ver_list list-pc">
													<caption class="sr-only"><spring:message code="payment.tab4.content66"/></caption>
													<colgroup>
														<col style="width:14%;" span="7">
													</colgroup>
													<thead>
														<tr>
															<th scope="col"><spring:message code="payment.tab4.content67"/></th>
															<th scope="col"><spring:message code="payment.tab4.content68"/></th>
															<th scope="col"><spring:message code="payment.tab4.content69"/></th>
															<th scope="col"><spring:message code="payment.tab4.content70"/></th>
															<th scope="col"><spring:message code="payment.tab4.content71"/></th>
															<th scope="col"><spring:message code="payment.tab4.content72"/></th>
															<!-- <th scope="col">취소일자</th> -->
														</tr>
													</thead>
													<tbody id="car-number_list">
														<tr>
															<td colspan="6"><spring:message code="payment.tab4.content73"/></td>
														</tr>
													</tbody>
												</table>
												<!-- mobile table -->
												<div id="mobile_list">
													<table class="list ver_list list-mobile">
														<caption class="sr-only"><spring:message code="payment.tab4.content74"/></caption>
														<colgroup>
															<col style="width:100%;">
														</colgroup>
														<thead>
															<tr>
																<th colspan="2"><spring:message code="payment.tab4.content75"/></th>
															</tr>
														</thead>
														<tbody>
															<tr>
																<td colspan="2"><spring:message code="payment.tab4.content76"/></td>
															</tr>
														</tbody>
													</table>
												</div>
											</div>
											<form id="btnForm" name="btnForm" method="post">
												<input type="hidden" name="xlsxApplyId"	value="${sessionScope.USER.userId}"/>
												<input type="hidden" id="xlsxRegStartDt" name="regStartDt" value="${regStartDt}"/>
												<input type="hidden" id="xlsxRegEndDt" name="regEndDt" value="${regEndDt}"/>
												<input type="hidden" id="xlsxCarNo" name="carNo" />
												<input type="hidden" id="catagory" name="catagory" />
											</form>
											<%-- <div class="excel-list">
												<a href="javascript:void(0);" onclick="btn_carlistXlsx();" class="excel-btn"><spring:message code="payment.tab4.content77"/></a>
											</div> --%>
											<ul>
												<li class="explanation"><spring:message code="payment.tab4.content78"/></li>
											</ul>
											<!-- btn -->
											<div class="btn-row">
												<ul class="btn-list">
													<li class="one-btn"><a href="<c:url value='/payment/select_payment_card.do' />" class="btn-type1" id=""><spring:message code="payment.tab4.content79"/></a></li>
												</ul>
											</div>
										</div>
										<div id="layer9" class="pop-layer">
										    <div class="pop-container">
										        <div class="pop-conts">
										        	<div class="pop-tit">
										        		<ul>
										        			<li><spring:message code="payment.tab4.content80"/></li>
										        			<li><a href="javascript:void(0);" class="icon-close btn-Close"></a></li>
										        		</ul>
										        	</div>
										        	<div class="pop-cont">
										        		<h3><spring:message code="payment.tab4.content81"/></h3>
													</div>
										        </div>
										        <div class="btn-row">
										            <ul class="btn-list">
														<li class="two-btn"><a href="javascript:void(0);" id="receipt_add"><spring:message code="payment.tab4.content82"/></a></li>
														<li class="two-btn"><a href="javascript:void(0);"><spring:message code="payment.tab4.content83"/></a></li>
													</ul>
												</div>
										    </div>
										</div>
										<div id="layer10" class="pop-layer">
										    <div class="pop-container">
										        <div class="pop-conts">
										        	<div class="pop-tit">
										        		<ul>
										        			<li><spring:message code="payment.tab4.content84"/></li>
										        			<li><a href="javascript:void(0);" class="icon-close btn-Close"></a></li>
										        		</ul>
										        	</div>
										        	<div class="pop-cont">
										        		<h3><spring:message code="payment.tab4.content85"/></h3>
											          <!--   <ul class="btn-list">
															<li class="btn">
																<a href="javascript:void(0);" class="btn-Close btn-type1">확인</a>
															</li>
														</ul> -->
													</div>
													<div class="btn-row">
											            <ul class="btn-list">
															<li class="popup-one-btn"><a href="javascript:void(0);"><spring:message code="payment.tab4.content86"/></a></li>
														</ul>
													</div>
										        </div>
										    </div>
										</div>
									</article>
								</section>
							</div>
						</div>
					</div>
				</article>
			</section>
		</section>
	</main>
	<div class="pop-layer" id="parking-list">
		<div class="pop-container">
			<div class="pop-conts">
				<div class="pop-tit">
					<ul>
						<li><spring:message code='payment.jsp.content1'/></li>
						<li><a href="javascript:void(0);" class="icon-close btn-Close"></a></li>
					</ul>
				</div>
				<div class="pop-cont" id="div_map" style="height: 400px;">
				</div>
			</div>
		</div>
	</div>
	<c:import url='/main/footer.do' />
	</div>
</body>

<script src="//dapi.kakao.com/v2/maps/sdk.js?appkey=5696dc0bc63d1cabc3c2f5f6fb4f8a79&libraries=services"></script>
<script src="<c:url value='/resources/js/map.js'/>"></script>

<script>

	var baseflag = 0; 
	//카드정보
	var carddata = [];
	var editcardstl = "";
	//카드 갯수파악
	var cardcount = 0;
	//최소 카드 등록 판단용
	var paystat = 0;
	//차량 입차조회 리스트
	var carlist;
	var carindex;
	//결제 타이머
	var receiptflag = 0;
	var x;
	// 선납 차량조회 리스트
	var car_payment_list;
	var car_payment_index;
	
	// 선납차량정보
	var now = new Date();
	var year= now.getFullYear();
	var mon = (now.getMonth()+1)>9 ? ''+(now.getMonth()+1) : '0'+(now.getMonth()+1);
	var day = now.getDate()>9 ? ''+now.getDate() : '0'+now.getDate();
	var chan_val = year + '.' + mon + '.' + day;
	var beforeTab = "";
	var allTab = "parkingTab2";
	var allParking = "all";
	var clickChk = true;
	var beforeParkingMap = {};
	var saveParkingMap = {};
	
	var sectnList = "";
	
	var isMobile = null;
	
	if(isMobileDevice()){
		isMobile = true;
	}else{
		isMobile = false;
	}
	
	var fn_Pop_Close;
	
	$(".calendar li input").val(chan_val);  
	
	function fCallUrl(menuNo, upperMenuId, url) {
		var form = document.mainManageLeftForm;
		form.subMenu1.value         = menuNo;
		form.subMenu2.value         = upperMenuId;
		form.upperMenuParamId.value = upperMenuId;
		form.action                 =  '<c:out value="${contextPath}"/>' + url;
		form.submit();
	}
	
	//로그인시 주소 대입
	var sessionChk = "${sessionScope.USER.userNm}";
	
	function carno_edit(){
		ajax_carno_edit(car_payment_index);
	}
	
	function ajax_carno_edit(index){
		$.ajax({
			  url      : "<c:url value='/payment/carno_edit.do' />"
			, type     : "POST"
			, data     : {	applyId : $("#applyId").val(),
							carregtId : car_payment_list[index].carregtId,
							carNo : car_payment_list[index].carNo,
							inOutId : car_payment_list[index].inOutId,
							paymentAmt : car_payment_list[index].paymentAmt,
							paymentTm : car_payment_list[index].paymentTm
						}
			, dataType : "json"
			, success  : function(data){
				
				if(data.data){
				
					
					if(data.data.result){
						layer_popup($("#layer10"));
						btn_carlist();
					}else{
						$("#applyPop8Text").html("<spring:message code='payment.jsp.content2'/>");
						layer_popup($("#layer8"));
						//alert("차량 데이터를 찾지 못했습니다.");
					}
				}else{
					$("#applyPop8Text").html("<spring:message code='payment.jsp.content3'/>");
					layer_popup($("#layer8"));
					//alert("<spring:message code='payment.jsp.content3'/>");
				}
				
			}
			, error    : function(request,error){
				$("#applyPop8Text").html("<spring:message code='payment.jsp.content4'/>");
				layer_popup($("#layer8"));
				//alert("code:"+request.status+"\n"+"error:"+error);
			}
		});
	}
	
	//선납 차량등록정보 리스트조회
	function btn_carlist(){
		
		var numchk = /([0-9]{4})/g;
		
		var carNumChk =$("#car-number_carNo").val(); 
	
		if(numchk.test(carNumChk)){
			ajax_car_payment_list();
		}else{
			if(carNumChk.length > 0){
				$("#applyPop15Text").html("<spring:message code='payment.jsp.content5'/>");
				layer_popup($("#layer15"));
				//alert("정확한 차량번호를 입력해주세요.")
			}else{
				ajax_car_payment_list(); 
			}
		}
	}
	
	function btn_car_cancel(listindex){
		layer_popup($("#layer9"));
		car_payment_index = listindex;
	}
	
	function ajax_car_payment_list(){
		$.ajax({
			  url      : "<c:url value='/payment/carno_list.do' />"
			, type     : "POST"
			, data     : {	applyId : $("#applyId").val(),
							carNo : $("#car-number_carNo").val(),
							regStartDt : $("#regStartDt").val(),
							regEndDt : $("#regEndDt").val(),
							catagory : "car_payment_list" 
						}
			, dataType : "json"
			, success  : function(data){
				
				if(data.data){
					var totalContent = '';
					var content = '';
					var mobileContent = '';
					totalContent += '<li class="font-color-blue bulit-type2" id="totalPay"><spring:message code="payment.jsp.content6"/> '+data.data.data.paymentCntTot+'건 / '+data.data.data.paymentAmtTot+'원</li>'
					$('#totalPay').replaceWith(totalContent);
					
					content += '<tbody id="car-number_list">';
					if(data.data.result){
						if(data.data.data.paymentCntTot > 0){
							
							car_payment_list = data.data.data.list;
							
							for(i = 0; i < car_payment_list.length; i++){
								mobileContent += '<table class="list ver_list list-mobile">'
									+'<caption class="sr-only"><spring:message code="payment.tab4.content74"/></caption>'
									+'<colgroup>'
									+	'<col style="width:50%;">'
									+	'<col style="width:50%;">'
									+'</colgroup>'
									+'<thead>'
									+'<tr>'
									+'<th scope="col">'+carNoMasking(car_payment_list[i].carNo)+'</th>'
									+'<th scope="col">'+car_payment_list[i].parkingNm+'</th>'
									+'</tr>'
									+'</thead>'
									+'<tbody>'
									+'<tr>'
									+'<td colspan="2"><spring:message code="payment.tab4.content12"/> : '+car_payment_list[i].inDttm+'</td>'
									+'</tr>'
									+'<tr>'
									+'<td colspan="2"><spring:message code="payment.tab4.content70"/> : '+car_payment_list[i].outDttm+'</td>'
									+'</tr>'
									+'<tr>'
									+'<td colspan="2"><spring:message code="payment.tab4.content71"/> : '+car_payment_list[i].regDttm+'</td>'
									+'</tr>'
									+'<tr>'
									+'<td colspan="2"><spring:message code="payment.jsp.content7"/> : '+car_payment_list[i].paymentAmt+'원</td>'
									+'</tr>'
									+'</tbody>'
									+'</table>';
								
								content += '<tr>';
								content += '<td>'+car_payment_list[i].parkingNm+'</td>';
								content += '<td class=\"font_center\">'+carNoMasking(car_payment_list[i].carNo)+'</td>'
								content += '<td>'+car_payment_list[i].inDttm+'</td>';
								content += '<td>'+car_payment_list[i].outDttm+'</td>';
								content += '<td>'+car_payment_list[i].regDttm+'</td>';
								content += '<td>'+car_payment_list[i].paymentAmt+'원</td>';
								content += '</tr>';
								
							}
							
						}else{
							content += '<tr>';
							content += '<td colspan=\"6\"><spring:message code="payment.tab4.content73"/></td>';
							content += '</tr>';
							
							mobileContent += '<table class="list ver_list list-mobile">'
								+ '<caption class="sr-only"><spring:message code="payment.tab4.content74"/></caption>'
								+ '<colgroup>'
								+ '<col style="width:100%;">'
								+ '</colgroup>'
								+ '<thead>'
								+ '<tr>'
								+ '<th colspan="2"><spring:message code="payment.tab4.content75"/></th>'
								+ '</tr>'
								+ '</thead>'
								+ '<tbody>'
								+ '<tr>'
								+ '<td colspan="2"><spring:message code="payment.tab4.content73"/></td>'
								+ '</tr>'
								+ '</tbody>'
								+ '</table>';
						}
						
					}else{
						content += '<tr>';
						content += '<td colspan=\"6\"><spring:message code="payment.tab4.content73"/></td>';
						content += '</tr>';
						
						mobileContent += '<table class="list ver_list list-mobile">'
						+ '<caption class="sr-only"><spring:message code="payment.tab4.content74"/></caption>'
						+ '<colgroup>'
						+ '<col style="width:100%;">'
						+ '</colgroup>'
						+ '<thead>'
						+ '<tr>'
						+ '<th colspan="2"><spring:message code="payment.tab4.content75"/></th>'
						+ '</tr>'
						+ '</thead>'
						+ '<tbody>'
						+ '<tr>'
						+ '<td colspan="2"><spring:message code="payment.tab4.content73"/></td>'
						+ '</tr>'
						+ '</tbody>'
						+ '</table>';
					}
	
					content += '</tbody>';
					$('#car-number_list').replaceWith(content);
					$('#mobile_list').html(mobileContent);
				}else{
					$("#applyPop8Text").html("<spring:message code='payment.jsp.content3'/>");
					layer_popup($("#layer8"));
					//alert("<spring:message code='payment.jsp.content3'/>");
				}
				
			}
			, error    : function(request,error){
				$("#applyPop8Text").html("<spring:message code='payment.jsp.content4'/>");
				layer_popup($("#layer8"));
				//alert("code:"+request.status+"\n"+"error:"+error);
			}
		});
	}
	
	function carNoMasking(carNo){
		var maskingData = '';
		var carNoPattern = /^\s*([가-히]{2}){0,1}\s*[0-9]{2,3}[\s]*[가-히]{1}[\s]*[0-9]{4}\s*$/gi;
		var carNoPattern1 = /^\s*([가-히]{2}){0,1}\s*[0-9]{2,3}[\s]*[가-히]{1}[\s]*[0-9]{4}\s*$/gi;
		var yesOrNo = carNoPattern.test(carNo);
		
		if(yesOrNo){
			maskingData = carNo.replace(carNo.substring(0,3),'***');
		}
		
		return maskingData;
	}

	// 결제 시간제한 타이머 receiptflag = 1 일때 결제가능
	function timer(){
		var time = 0;
		var limit = 30;
		
		x = setInterval(function(){
			
			
			if(time == limit){
				clearInterval(x);
				receiptflag = 0;
			}
			time++;
			
		}, 1000)
	}
	
	//선납 주차요금 수납 ajax
	function ajax_car_receipt(div, payTm, payAmt, index){
		$.ajax({
			  url      : "<c:url value='/payment/carno_add.do' />"
			, type     : "POST"
			, data     : {	
							carNo : carlist[index].carNo,
							paymentDiv : div,
							payTm : payTm,
							payAmt : payAmt,
							outDttm : carlist[index].outDttm,
							inOutId : carlist[index].inOutId,
							applyId : $("#applyId").val()
						}
			, dataType : "json"
			, success  : function(data){
				if(data.data){
					if(data.data.result){
						layer_popup($("#layer16"));
						$("#layer7").hide();
					}else{
						if(data.data.data == "이미 선납처리된 차량번호입니다."){
							$("#applyPop8Text").html("<spring:message code='payment.jsp.content8'/>");
							layer_popup($("#layer8"));
							$("#layer7").hide();
						}else if(data.data.data.resultMsg == "결제가 실패하였습니다."){
							$("#applyPop8Text").html("<spring:message code='payment.jsp.content9'/>");
							layer_popup($("#layer8"));
							$("#layer7").hide();
						}else if(data.data.data.resultMsg == "거래 거절(사용 한도초과)"){
							$("#applyPop8Text").html("<spring:message code='payment.jsp.content10'/>");
							layer_popup($("#layer8"));
							$("#layer7").hide();
						}else{
							$("#applyPop8Text").html(data.data.data.resultMsg);
							layer_popup($("#layer8"));
							$("#layer7").hide();
						}
					}
					receiptflag = 1;  // 타이머 플래그
					clearInterval(x); // 타이머 초기화
					timer();          // 타이머
					//window.location.href = "/payment/select_payment_car.do";//결제완료시 화면 리로드
				}else{
					$("#applyPop8Text").html("<spring:message code='payment.jsp.content3'/>");
					layer_popup($("#layer8"));
					//alert("<spring:message code='payment.jsp.content3'/>");
				}
				
			}
			, error    : function(request,error){
				$("#applyPop8Text").html("<spring:message code='payment.jsp.content4'/>");
				layer_popup($("#layer8"));
				//alert("code:"+request.status+"\n"+"error:"+error);
			}
		});
	}
	
	// 리스트 차량번호 클릭
	function SetTmAmt(index){
		ajaxbase_get();

		$("#carlistindex").val(index);
		$("#accNumMaxTm").val(carlist[index].parkingTm);
		$("#accNumMaxAmt").val(carlist[index].parkingAmt);
		if($("#accNumMaxAmt").val() > carlist[index].parkingAmt){
			$("#baseAmtResult").val(carlist[index].parkingAmt);
		}
		$("#baseAllAmtResult").val(carlist[index].parkingAmt);
		$("#accNumAllAmt").val(carlist[index].parkingAmt);
	}
	
	//차량 리스트 
	function ajaxcarinlist(){
		$.ajax({
			  url      : "<c:url value='/payment/carno_list.do' />"
			, type     : "POST"
			, data     : {	applyId : $("#applyId").val(),
							carNo : $("#carNo").val(),
							catagory : "none"
						}
			, dataType : "json"
			, success  : function(data){
				if(data.data){
				
					var content = '';
					var mobileContent = '';
					
					if(data.data.result){
						
						if(data.data.data.paymentCntTot > 0){
							
							carlist = data.data.data.list;
							
							for(i = 0; i < carlist.length; i++){
								mobileContent += '<table class="list ver_list list-mobile">'
									+'<caption class="sr-only"><spring:message code="payment.tab4.content74"/></caption>'
									+'<colgroup>'
									+	'<col style="width:50%;">'
									+	'<col style="width:50%;">'
									+'</colgroup>'
									+'<thead>'
									+'<tr>'
									+'<th scope="col"><a href=\"javascript:void(0);\" class=\"vehicle-add\" data-carindex=\"'+i+'\">'+carlist[i].carNo+'</a><button type=\"button\" class=\"small-btn-m\">선택</button></th>'
									+'<th scope="col">'+carlist[i].parkingNm+'</th>'
									+'</tr>'
									+'</thead>'
									+'<tbody>'
									+'<tr>'
									+'<td colspan="2">'+carlist[i].inDttm+'</td>'
									+'</tr>'
									+'<tr>'
									+'<td>'+carlist[i].parkingTm+'분</td>'
									+'<td>'+carlist[i].parkingAmt+'원('+carlist[i].discountNm+')</td>'
									+'</tr>'
									+'</tbody>'
									+'</table>';
								
								content += '<tr>';
								content += '<td>'+carlist[i].parkingNm+'</td>';
								content += '<td><a href=\"javascript:void(0);\" class=\"vehicle-add\" data-carindex=\"'+i+'\">'+carlist[i].carNo+'</a><button type=\"button\" class=\"small-btn\">선택</button></td>';
								content += '<td>'+carlist[i].inDttm+'</td>';
								content += '<td>'+carlist[i].discountNm+'</td>';
								content += '<td>'+carlist[i].parkingTm+'</td>';
								content += '<td>'+carlist[i].parkingAmt+'</td>';
								content += '</tr>';
								
							}
							
						}else{
							content += '<tr>';
							content += '<td colspan=\"6\"><spring:message code="payment.tab4.content73"/></td>';
							content += '</tr>';
						}
						
					}else{
						content += '<tr>';
						content += '<td colspan=\"6\"><spring:message code="payment.tab4.content73"/></td>';
					
						content += '</tr>';
					}
					$('#carintable').html(content);
					
					$('#carintableMoblie').html(mobileContent);
					$('.information-payment').removeClass('show');
					$('.information-payment').addClass('hide');
					$.loadingStop();
					ajaxbase_get();
				}else{
					$.loadingStop();
					$("#applyPop8Text").html("<spring:message code='payment.jsp.content3'/>");
					layer_popup($("#layer8"));
					//alert("<spring:message code='payment.jsp.content3'/>");
				}
				
			}
			, error    : function(request,error){
				$.loadingStop();
				$("#applyPop8Text").html("<spring:message code='payment.jsp.content4'/>");
				layer_popup($("#layer8"));
				//alert("code:"+request.status+"\n"+"error:"+error);
			}
		});
	}
	
	//선납 기준정보 조회ajax
	function ajaxbase_add(path, div){
		$.ajax({
			  url      : "<c:url value='/payment/base_add.do' />"
			, type     : "POST"
			, data     : {	applyId : $("#applyId").val(),
							path : path,
							basePaymentDiv : div,
							basePaymentTime : $("#baseSetTm").val(),
							basePaymentAmt : $("#baseSetAmt").val()
						}
			, dataType : "json"
			, success  : function(data){
				
				if(data.data){
					layer_popup($("#layer12"));
				}else{
					$("#applyPop8Text").html("<spring:message code='payment.jsp.content3'/>");
					layer_popup($("#layer8"));
					//alert("<spring:message code='payment.jsp.content3'/>");
				}
			}
			, error    : function(request,error){
				$("#applyPop8Text").html("<spring:message code='payment.jsp.content4'/>");
				layer_popup($("#layer8"));
				//alert("code:"+request.status+"\n"+"error:"+error);
			}
		});
	}
	
	//선납 기준정보 조회ajax
	function ajaxbase_get(){
		$.ajax({
			  url      : "<c:url value='/payment/base_get.do' />"
			, type     : "POST"
			, data     : { applyId : $("#applyId").val() }
			, dataType : "json"
			, success  : function(data){
				
				if(data.data){
				
					var _r = data.data.data;
					
					if(data.result || _r){
						// 있을때
						var baseinfo = data.data.data;
						
						baseInfoSet(baseinfo);
							
						baseflag = 1;
						
					}else{
						baseflag = 0;
					}
					
				}else{
					$("#applyPop8Text").html("<spring:message code='payment.jsp.content3'/>");
					layer_popup($("#layer8"));
					//alert("<spring:message code='payment.jsp.content3'/>");
				}
			}
			, error    : function(request,error){
				$("#applyPop8Text").html("<spring:message code='payment.jsp.content4'/>");
				layer_popup($("#layer8"));
				//alert("code:"+request.status+"\n"+"error:"+error);
			}
		});		
	}
	
	function baseInfoSet(data){
		
		//$("#baseAllAmtResult").val(data.paymentAmt);
		$("#baseAmtResult").val(data.paymentAmt);
		$("#baseTmResult").val(data.paymentTm);
		$("#baseSetAmt").val(data.paymentAmt);
		$("#baseSetTm").val(data.paymentTm);
		
		$("#accNumTm").val(data.paymentTm);
		$("#accNumAmt").val(data.paymentAmt);
		
		$("ul.payment-division li").removeClass("checked");
		$("#payment-time").prop("checked", false);
		$("#payment-fee").prop("checked", false);
		$("#payment-full").prop("checked", false);
		$(".division-content").removeClass("on");
		
		if(data.paymentDiv === "PMD-001"){
			
			$("#baseTm").addClass("checked");
			$("#division-tab1").addClass("on");
			
			$("#payment-time").prop("checked", true);

			
		}else if(data.paymentDiv === "PMD-002"){
			$("#baseAmt").addClass("checked");
			$("#division-tab2").addClass("on");

			$("#payment-fee").prop("checked", true);
			
		}else if(data.paymentDiv === "PMD-003"){
			
			$("#baseAllAmt").addClass("checked");
			$("#division-tab3").addClass("on");
			
			$("#payment-full").prop("checked", true);
			
		}
		
	}
	
	function btn_card_delete(){
		layer_popup($("#layer3"));
	}
	
	//결제카드취소 ajax
	function ajaxcard_edit(){
		$.ajax({
			  url      : "<c:url value='/payment/card_edit.do' />"
			, type     : "POST"
			, data     : { editcardstl : editcardstl }
			, dataType : "json"
			, success  : function(data){
				if(!data.result || data.result.length <= 0){
					ajaxcardList();
				}else{
					$("#applyPop8Text").html("<spring:message code='payment.jsp.content11'/>");
					layer_popup($("#layer8"));
					//alert("카드 폐기중에 오류가 발생하였습니다.");
				}
			}
			, error    : function(request,error){
				$("#applyPop8Text").html("<spring:message code='payment.jsp.content4'/>");
				layer_popup($("#layer8"));
				//alert("code:"+request.status+"\n"+"error:"+error);
			}
		});
		
	}
    
	//선납 서비스 신청 ajax 
	function ajaxpay_add(){
		
		var phone = $("#phone1").val() +"-"+ $("#phone2").val() +"-"+ $("#phone3").val();
		var busRgtNo = ""+$("#busRgtNo1").val() + $("#busRgtNo2").val() + $("#busRgtNo3").val();
		var busTelNo = ""+$("#busTelNo1").val() +"-"+ $("#busTelNo2").val() +"-"+ $("#busTelNo3").val();
		
			$.ajax({
				  url      : "<c:url value='/payment/add.do' />"
				, type     : "POST"
				, data     : { applyId : $("#applyId").val()
							,  applyNm : $("#useraddrnm").text()
							,  addr : $("#useraddrtxt").text().trim()
							,  phone : phone
							,  busRgtNo : busRgtNo
							,  busNm : $("#busNm").val()
							,  busTelNo : busTelNo
							,  sectnList : sectnList
							}
				, dataType : "json"
				, success  : function(data){
					if(data.data == "done"){
						layer_popup($("#layer2"));
					}else{
						$("#applyPop8Text").html("<spring:message code='payment.jsp.content12'/>");
						layer_popup($("#layer8"));
						//alert("서비스 신청 실패");
					}
				}
				, error    : function(request,error){
					$("#applyPop8Text").html("<spring:message code='payment.jsp.content4'/>");
					layer_popup($("#layer8"));
					//alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
				}
			});
		
	}
	
	// 결제폼 생성 ajax
	function ajaxpay_form(){
		
    	$.ajax({
			  url      : "<c:url value='/payment/pay_form.do' />"
			, type     : "POST"
			, data     : { applyId : $("#applyId").val() }
			, dataType : "json"
			, success  : function(data){
				console.dir(data);
				if(data.state == "done"){
					paystat = 1;
					$("#tab3").append(data.paymentForm);
					mkpayform();
				}else{
					$("#applyPop8Text").html("<spring:message code='payment.jsp.content13'/>");
					layer_popup($("#layer8"));
					//alert("결제 화면생성에 오류가 발생하였습니다.");
				}
			}
			, error    : function(request,error){
				$("#applyPop8Text").html("<spring:message code='payment.jsp.content4'/>");
				layer_popup($("#layer8"));
				//alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
			}
		});
    	
    }
	
	// 결제 창 띄우는 ajax
    function mkpayform(){
        
    	$('.pop-layer').fadeOut();
		
    	var mode 			= 'ssb';
    	var payFormNm		= document.payForm;
    	var BrowserType		= '';

    	if(navigator.appName.indexOf("Microsoft") > -1){
    		if(navigator.appVersion.indexOf("MSIE 7") > -1){
    			BrowserType = "MSIE 7";
    		}else if(navigator.appVersion.indexOf(navigator.appVersion.indexOf("MSIE 6") > -1)){
    			BrowserType = "MSIE 6";
    		}
    	}
    	
    	payFormNm.action		= getPGUrl("payForm",mode);

//    	CharacterSet Setting ==============================================================
    	var encodingType 	= "EUC-KR";
    	if(isBrowserCheck() != 'N/A'){
    		document.charset = encodingType;		// ie
    	}else{
    	  	payFormNm.charset = encodingType;		// else 
    	}
    //=====================================================================================
    	
    	if(payFormNm.FORWARD.value == 'Y'){
    		var left = (screen.Width - 545)/2;
    		var top = (screen.Height - 573)/2;
    		var winopts = "left=" + left + ", top=" + top + ", width=545, height=573, toolbar=no, location=no, directories=no, status=yes, menubar=no, scrollbars=no, resizable=no";
    		var win =  window.open("", "payWindow", winopts);	
    		payFormNm.target = "payWindow";
    		payFormNm.submit();
    	}else{
    		payFormNm.target = "payFrame";
    		payFormNm.submit();
    		payFormNm.PayMethod.value = "";
    		payFormNm.payType.value = "";
    	}
		
		ajaxcardList();
    }
    
	//카드 리스트ajax
    function ajaxcardList(){
		
    	$.ajax({
			  url      : "<c:url value='/payment/card_list.do' />"
			, type     : "POST"
			, data     : { applyId : $("#applyId").val() }
			, dataType : "json"
			, success  : function(data){
				console.dir(data);
				var content = '';
				var mobileContent = '';
            	content += '<tbody id="tb_card_list">';
            	
					if((!data.result || data.result.length <= 0 ) && data.data != "none"){
						
						if(data.data.data != "요청하신 ID의 카드정보가 존재하지 않습니다." && data.data.data != "요청하신 데이터를 찾을 수 없습니다."){
							
							
							carddata = data.data.data;
				            for (var i = 0; i < carddata.length; i++) {
				            	//carddata.length
			        			if(carddata[i].disposalDttm == null){
			        				editcardstl = carddata[i].stlmntId; 
			        			}
			        			
					            content += '<tr id="' + carddata[i].ID + '">';
					            content += '<td> ['+carddata[i].issuerCardNm +']'+ carddata[i].displayCardNo;
					            
								mobileContent += '<table class="list ver_list list-mobile">'
												+'<caption class="sr-only"><spring:message code="payment.tab3.content8"/></caption>'
												+'<colgroup>'
												+'	<col style="width:100%;">'
												+'</colgroup>'
												+'<thead>'
												+'<tr>'
												+'<th scope="col">['+carddata[i].issuerCardNm +']'+ carddata[i].displayCardNo+'</th>'
												+'</tr>'
												+'</thead>'
							            		+'<tbody>'
												+'<tr>'
												+'<td>'
												+'<ul>'
												+'<li>등록일시 : '+carddata[i].approvalDttm+'</li>';
										
					            if(carddata[i].disposalDttm == null){
					            	content += "<span><a href=\"javascript:void(0);\" onclick=\"btn_card_delete();\"><spring:message code='payment.jsp.content14'/></a></span>";
					            	content += '</td>';
					            	
					            	mobileContent += '<li>'
													+'<span><a href=\"javascript:void(0);\" onclick=\"btn_card_delete();\"><spring:message code="payment.jsp.content14"/></a></span>'
													+'</li>';
								}else{
									content += '</td>';
									
									mobileContent += '<li><spring:message code="payment.jsp.content15"/> : '+carddata[i].disposalDttm +'</li>';
													+ '<li>'
													+'</li>';
								}
										
							 mobileContent	+='</ul>'
										+'</td>'
										+'</tr>'
										+'</tbody>'
										+'</table>';
					            
				           		content += '<td>' + carddata[i].approvalDttm + '</td>';
				           	 
					            if(carddata[i].disposalDttm == null){
					            	content += '<td>' + " - " + '</td>';
					            	cardcount = 1;
								}else{
						            	content += '<td>' + carddata[i].disposalDttm + '</td>';
								}
				            
				            content += '</tr>';
								
				            }
							
						}else{
							mobileContent = '<table class="list ver_list list-mobile">'
							+'<caption class="sr-only"><spring:message code="payment.tab3.content8"/></caption>'
							+'<colgroup>'
							+'	<col style="width:100%;">'
							+'</colgroup>'
							+'<thead>'
							+'	<tr>'
							+'		<th scope="col"><spring:message code="payment.tab3.content4"/></th>' 
							+'	</tr>'
							+'</thead>'
							+'<tbody>'
							+'	<tr>'
							+'		<td style="text-align:center; padding-left:0px;"><spring:message code="payment.tab3.content10"/></td>'
							+'	</tr>	'
							+'</tbody>'
							+'</table>'
							
							content += '<tr>';
							content += '<td colspan=\"3\" class=\"td_center\"> <spring:message code="payment.tab3.content10"/> </td>';
							content += '</tr>';
							cardcount = 0;
						}
					
					}else{
						$("#applyPop8Text").html("<spring:message code='payment.jsp.content3'/>");
						layer_popup($("#layer8"));
						//alert("<spring:message code='payment.jsp.content3'/>.");
						
						content += '<tr>';
						content += '<td colspan=\"3\" class=\"td_center\"> <spring:message code="payment.tab3.content10"/> </td>';
						content += '</tr>';
						cardcount = 0;
						
					}
					
					content += '</tbody>';
					$('#tb_card_list').replaceWith(content);
					
					$('#mobile_test').html(mobileContent);
			}
			, error    : function(request,error){
				$("#applyPop8Text").html("<spring:message code='payment.jsp.content4'/>");
				layer_popup($("#layer8"));
				//alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
			}
		});
		
    };
	
  	//서비스 신청 정보 ajax
    function ajaxgetInfo(){
		
    	$.ajax({
			  url      : "<c:url value='/payment/get.do' />"
			, type     : "POST"
			, data     : { applyId : $("#applyId").val() }
			, dataType : "json"
			, success  : function(data){
				
				var searchFlag = "";
				
				if((!data.result || data.result.length <= 0 ) && data.data != "none"){
					
					var list = data.data.data;
					console.dir(data.data.data);
					
					if(list != "요청하신 ID의 카드정보가 존재하지 않습니다."){	
											
						$("#useraddrnm").val(list.applyNm);
						
						var phone = list.mobile;
						var busRgtNo = list.bmanRgtNo;
						var busTelNo = list.busTelNo;
						var sectnList = list.sectnList;
						var sectnListLength = sectnList.length;
						//var searchParkingList = data.searchParkingList;
						
						searchFlag = list.allYn == "Y" ? allParking : "";
						
						for(var i = 0; i < sectnListLength; i++){
							beforeParkingMap[sectnList[i].sectnId] = getObjData(sectnList[i]);
							saveParkingMap[sectnList[i].sectnId] = setData(beforeParkingMap[sectnList[i].sectnId]);
						}
						
						var phoneStr = phone.split('-');
						var busTelNoStr = busTelNo.split('-');
						
						$("#lefttab1").removeClass("active");
						$("#lefttab2").addClass("active");
						
						$("#useraddrnm").val(list.applyNm);
						$("#useraddrtxt").val(list.addr);
						
						$("#phone1").val(phoneStr[0]);
						$("#phone2").val(phoneStr[1]);
						$("#phone3").val(phoneStr[2]);
						
						$("#busRgtNo1").val(busRgtNo.substring(0,3));
						$("#busRgtNo2").val(busRgtNo.substring(3,5));
						$("#busRgtNo3").val(busRgtNo.substring(5,10));
						
						$("#busNm").val(list.busNm);
						
						$("#busTelNo1").val(busTelNoStr[0]);
						$("#busTelNo2").val(busTelNoStr[1]);
						$("#busTelNo3").val(busTelNoStr[2]);
						
						$("#applyPop1Text").html();
						$("#applyPop1Text").html(data.applyPop1Text);
						$("#applyPop2Text").html();
						$("#applyPop2Text").html(data.applyPop2Text);
						
						$("#btn_serviceapply").html("<spring:message code='payment.jsp.content16'/>");
						
					}
				}	
				
				if(allParking == searchFlag){					
					$("#parkingAllAddBtn").text("<spring:message code='payment.jsp.content17'/>").addClass(allParking);
					$("#parkingMapAddBtn").hide();
				}
				
				parkingList(searchFlag);
				
			}
			, error    : function(request,error){
				$("#applyPop8Text").html("<spring:message code='payment.jsp.content4'/>");
				layer_popup($("#layer8"));
				//alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
			}
		});
		
    };
	
    function layer_popup(el){
        var $el = $(el); 
        var isDim = $el.prev().hasClass('dim');
		
        isDim ? $('.dim').fadeIn() : $el.fadeIn();
            
        $el.find('a.btn-layerClose').click(function(){
        	$('.pop-layer').css("display","none");
            $el.fadeOut(); // 닫기 버튼을 클릭하면 레이어가 닫힌다.
            return false;
        });
        
  		$(".btn-Close").click(function(){
  			$('.pop-layer').css("display","none");
  			$el.fadeOut();
            return false;
        });
  		
  		$(".btn-Close2").click(function(){
  			$('.pop-layer').fadeOut();
  			window.location.href = "/payment/select_payment_car.do";
            return false;
        });
    }
    
	
  	function onPopupClosed(){
  		location.reload();
  	}
  	
  	function regPicker(){
  		
  		$("#regStartDt").datepicker({
  		    dateFormat: "yy-mm-dd",
  		    dayNames: [ "일", "월", "화", "수", "목", "금", "토" ],
  		    dayNamesMin: [ "일", "월", "화", "수", "목", "금", "토" ],
  		    monthNames: [ "1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월", "12월" ],
  		    beforeShow: function() {
  		        setTimeout(function(){
  		            $(".ui-datepicker").css("z-index", 10);
  		        }, 0);
  		    },
  		    onClose : function(date){
  		    	
  		    	var maxDate = new Date(date);
  		    	maxDate.setMonth(maxDate.getMonth()+6);
  		    	
  		    	$("#regEndDt").datepicker("option", "minDate", date);
  		    	$("#regEndDt").datepicker("option", "maxDate", maxDate);
  		    }
  		});
  		
  		$("#regEndDt").datepicker({
  		    dateFormat: "yy-mm-dd",
  		    dayNames: [ "일", "월", "화", "수", "목", "금", "토" ],
  		    dayNamesMin: [ "일", "월", "화", "수", "목", "금", "토" ],
  		    monthNames: [ "1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월", "12월" ],
  		    minDate : 'today',
  		    maxDate : '+6m',
  		    beforeShow: function() {
  		        setTimeout(function(){
  		            $(".ui-datepicker").css("z-index", 10);
  		        }, 0);
  		    }
  		    
  		});
  		
  	}
  	
  	function setParking(){
  		
  		$(".all_parking").each(function(){
			
			var target = $(this),
				tr = target.parents("tr"),
				selectChk = target.hasClass("select_parking"),
				data = getTrData(tr);
				
				if(selectChk){
					saveParkingMap[data.sectnId] = setData(data);
					beforeParkingMap[data.sectnId] = setData(data);
					
				}
				
		});
  		
  	}
  	
  	
$(function(){
	$(".btn-Close").click(function(){
			$('.pop-layer').css("display","none");
        return false;
    });
		regPicker();
	
		$("#paybtn").click(function(){
				
				if(receiptflag == 0){
					$("#applyPop8Text").html("<spring:message code='payment.jsp.content18'/>");
					layer_popup($("#layer8"));
					//alert("차량조회 후 30초가 지났습니다. 재 조회 후에 선납해주시기 바랍니다.");
					//onPopupClosed();
				}else{
				
					var accSumTm = parseInt($("#baseTmResult").val());
					var accSumAmt = parseInt($("#baseAmtResult").val());
					var accSumAllAmt = parseInt($("#baseAllAmtResult").val());
					var maxTm = parseInt($("#accNumMaxTm").val());
					var maxAmt = parseInt($("#accNumMaxAmt").val());
					
					if($("#baseTm").hasClass('checked')){

						if($("#baseTmResult").val() == ''){
							$("#applyPop8Text").html("<spring:message code='payment.jsp.content19'/>");
							layer_popup($("#layer8"));
							accSumTm = (isNaN(accSumTm)) ? 0 : accSumTm;
							$("#baseTmResult").val(accSumTm);
						}
						
						if(accSumTm == 0){
							$("#applyPop8Text").html("<spring:message code='payment.jsp.content19'/>");
							layer_popup($("#layer8"));
							//alert("정확한 선납 주차시간을 설정해주시기 바랍니다.");
							return false;
						}
						
						if(accSumTm == maxTm){
							$("#applyPop8Text").html("<spring:message code='payment.jsp.content20'/>");
							layer_popup($("#layer8"));
							//alert("총 주차시간을 선납하시려면 전액선납을 이용해주시기 바랍니다.");
							return false;
						}else if(accSumTm > maxTm){
							$("#applyPop8Text").html("<spring:message code='payment.jsp.content21'/>");
							layer_popup($("#layer8"));
							//alert("선납시간이 주차시간(분)보다 초과되었습니다.");
							return false;
						}
				    	
				    }else if($("#baseAmt").hasClass('checked')){
				    	
				    	if($("#baseAmtResult").val() == ''){
							$("#applyPop8Text").html("<spring:message code='payment.jsp.content19'/>");
							layer_popup($("#layer8"));
							accSumAmt = (isNaN(accSumAmt)) ? 0 : accSumAmt;
							$("#baseAmtResult").val(accSumAmt);
						}
				    	
				    	if(accSumAmt == 0){
				    		$("#applyPop8Text").html("<spring:message code='payment.jsp.content19'/>");
							layer_popup($("#layer8"));
							//alert("정확한 선납 주차요금을 설정해주시기 바랍니다.");
							return false;
						}
				    	
				    	if(accSumAmt == maxAmt){
				    		$("#applyPop8Text").html("<spring:message code='payment.jsp.content22'/>");
							layer_popup($("#layer8"));
							//alert("총 주차요금을 선납하시려면 전액선납을 이용해주시기 바랍니다.");
							return false;
						}else if(accSumAmt > maxAmt){
							$("#applyPop8Text").html("<spring:message code='payment.jsp.content23'/>");
							layer_popup($("#layer8"));
							//alert("선납요금이 주차요금(예상)보다 초과되었습니다.");
							return false;
						}
					    
				    }else if($("#baseAllAmt").hasClass('checked')){
				    	
				    	if(accSumAllAmt == 0){
				    		$("#applyPop8Text").html("<spring:message code='payment.jsp.content24'/>");
							layer_popup($("#layer8"));
							//alert("정확한 선납 주차요금을 설정해주시기 바랍니다.");
							return false;
						}
				    	
				    	if(accSumAllAmt > maxAmt){
				    		$("#applyPop8Text").html("<spring:message code='payment.jsp.content25'/>");
							layer_popup($("#layer8"));
				    		//alert("결제 금액이 총 주차금액보다 초과되었니다.");
							return false;
				    	}
				    	
				    }
				    layer_popup($("#layer7"));
				    
	 			}
		});
		
		// 햄버거 메뉴
		$(document).on("click", "#line-wrapper", function(){
			
			$("#top-line").toggleClass('top-line');
			$("#middle-line").toggleClass('middle-line');
			$("#bottom-line").toggleClass('bottom-line');
			$("#dim").toggleClass('on');
			$(".gnbNav-inner").toggleClass('on');
			$("body").toggleClass('on');
		});
		$(document).on("click", "#dim", function(){
			$("#top-line").toggleClass('top-line');
			$("#middle-line").toggleClass('middle-line');
			$("#bottom-line").toggleClass('bottom-line');
			$("#dim").toggleClass('on');
			$(".gnbNav-inner").toggleClass('on');
			$("body").toggleClass('on');
		});
		
		//accordion
		$(".menu-list").hide();
		$(document).on("click", ".menuList div > a", function(){
			$(this).css("color","0074c1");
			$(this).next().slideToggle(300);
			$(".menuList div > a").not(this).next().slideUp(300);
			return false;
		});
	
		$(".menuList div > a").eq(0).trigger("click");
		
 		// 차량 조회
 		$("#carinlist").click(function(){
 			$.loadingStart();
 			var numchk = /([0-9]{4})/g;

 			if(numchk.test($("#carNo").val())){
 				ajaxcarinlist();
 				receiptflag = 1;  // 타이머 플래그
 				clearInterval(x); // 타이머 초기화
 				timer();          // 타이머
 			}else{
	 			$.loadingStop();
 				$("#applyPop15Text").html("<spring:message code='payment.jsp.content5'/>");
				layer_popup($("#layer15"));
 			}
 			
 		});
 		
 		//선납 주차요금 수납등록
 		$("#receipt_add").click(function(){
 			if(receiptflag == 0){
 				$("#applyPop8Text").html("<spring:message code='payment.jsp.content18'/>");
				layer_popup($("#layer8"));
 				//onPopupClosed();
 			}else{
 				var index = $("#carlistindex").val();
 				var div = "";
 				var payTm = "";
 				var payAmt = "";
 				
 				if($("#baseTm").hasClass('checked')){
 			    	div = "PMD-001";
 			    	payTm = $("#baseTmResult").val();
					
 			    }else if($("#baseAmt").hasClass('checked')){
 			    	div = "PMD-002";
 			    	payAmt = $("#baseAmtResult").val();
 			    }else {
 			    	div = "PMD-003";
 			    	payAmt = $("#baseAllAmtResult").val();
 			    	payTm = carlist[index].parkingTm;
 			    }
 				ajax_car_receipt(div, payTm, payAmt,index);
 			}
 		});
 		
 		//상단 화살표 메뉴바 클릭이벤트 
 		$("ul#tabMenu li").click(function(){
	      location.href = "<c:url value='"+$(this).data("href")+"' />";
 		});
 			var step = $("#step").val();
 			
 			if(step != ""){
 				
 				$(".tabcontent").removeClass("on");
 				$("ul#tabMenu li").removeClass("on");
 				$("ul#tabMenu li").eq(step-1).addClass("on");
 				$("#tab"+step).addClass("on");
 				
				if(step == "2"){
					$("#btn_serviceapply").html("<spring:message code='payment.tab2.content24'/>");
					ajaxgetInfo();
				}
				
				if(step == "3"){
					ajaxcardList();
				}
				
				if(step == "4"){
					ajaxbase_get();
				}
 			}
 			
 			var currentDate = new Date();  
 			
 			$("#regStartDt").datepicker("setDate",(currentDate-7));
 			$("#regEndDt").datepicker("setDate",currentDate);
 			
 		//선납 기준정보 설정 확인버튼.
 		$("#btn_base").click(function(){
 			
 			var stck = $(":input:radio[name=payment]:checked").val();
 			var div = "";
 			
 			if(stck == "time"){
 				div = "PMD-001";
 			}else if(stck == "fee"){
 				div = "PMD-002";
 			}else if(stck == "full"){
 				div = "PMD-003";
 			}

 			if(baseflag == 1){
 				ajaxbase_add("edit", div);
 			}else{
 				ajaxbase_add("add", div);
 			}
 		});	
 		
 		// 선납 기준정보 설정 버튼 클릭시 작동.
 		$('.btn-apply-base').click(function(){
 			
 	        ajaxbase_get();
 			
 			var $href = $(this).attr('href');
 	        layer_popup($href);
 	        
 	        
 		});
 		
 		$("#cardAdd").click(function(){
 			
			if(paystat == 0){
				ajaxpay_form();
			}else{
				mkpayform();
			}
 			
 		});
 		
 		$("#btn_serviceapply").click(function(){
 			var tel1Exp = /^01(?:0|1|[6-9])/g,
				tel2Exp = /(^[0-9]{3}$|^[0-9]{4}$)/g,
		     	tel3Exp = /([0-9]{4})/g,
			
		     	busRN1Exp = /([0-9]{3})/g,
		     	busRN2Exp = /([0-9]{2})/g,
		     	busRN3Exp = /([0-9]{5})/g,
		     	
		     	busTelNo1Exp = /(^[0-9]{2}$|^[0-9]{3}$)/g,
		     	busTelNo2Exp = /(^[0-9]{3}$|^[0-9]{4}$)/g,
		     	busTelNo3Exp = /([0-9]{4})/g,
		     	
				tel1 = $("#phone1").val(),
		    	tel2 = $("#phone2").val(),
		    	tel3 = $("#phone3").val();
 			
 			
 			var scnt = 0;
 			
 				sectnList = "";
 			
 			if(isMobile){
 				
 				$("#mobileParkingList [data-select-sectnid").each(function(){
 	 				if(scnt > 0 ){
 	 					sectnList += ",";	
 	 				}
 	 				sectnList += $(this).data("select-sectnid");
 	 				scnt++;
 	 	         });
 				
 			}else{
 				$("#pcParkingList [data-select-sectnid").each(function(){
 	 				if(scnt > 0 ){
 	 					sectnList += ",";	
 	 				}
 	 				sectnList += $(this).data("select-sectnid");
 	 				scnt++;
 	 			});
 				
 			}
 			
 			if(!tel1Exp.test(tel1) || !tel2Exp.test(tel2) || !tel3Exp.test(tel3)){
				$("#applyPop14Text").html("<spring:message code='payment.jsp.content26'/>");
				layer_popup($("#layer14"));
				
		  	}else if(!busRN1Exp.test($("#busRgtNo1").val()) || !busRN2Exp.test($("#busRgtNo2").val()) || !busRN3Exp.test($("#busRgtNo3").val())){
		  		$("#applyPop14Text").html("<spring:message code='payment.jsp.content27'/>");
				layer_popup($("#layer14"));
		  		
		  	}else if(!$("#busNm").val() || $("#busNm").val().length > 50){
				$("#applyPop14Text").html("<spring:message code='payment.jsp.content28'/>");
				layer_popup($("#layer14"));
				
			}else if(!busTelNo1Exp.test($("#busTelNo1").val()) && !busTelNo2Exp.test($("#busTelNo2").val()) && !busTelNo3Exp.test($("#busTelNo3").val())){
				$("#applyPop14Text").html("<spring:message code='payment.jsp.content29'/>");
				layer_popup($("#layer14"));
				
		  	}/* else if(sectnList == 'empty' || scnt == 0 ){
 				$("#applyPop14Text").html("선납서비스를 이용하실 주차장을 선택해주세요.");
 				layer_popup($("#layer14"));
 			} */
		  	else{
		  	
				 /* if(sessionChk == ""){
					$("#applyPop14Text").html("로그인이 필요한 서비스 입니다.");
					layer_popup($("#layer14"));
					location.href = "/login/loginUsr.do";
				}else{ */
					if(!$("#privacyChk").is(":checked")){
						$("#applyPop14Text").html("<spring:message code='payment.tab4.content7'/>");
						layer_popup($("#layer14"));
					}else{
						layer_popup($("#layer1"));
					}
				//} 
			}
 		});
 		
 		// 선납서비스 신청버튼 step2
 		$("#btn_go_insert").click(function(){
 			ajaxpay_add();
 			
 			/* if(sessionChk == ""){
 				$("#applyPop8Text").html("로그인이 필요한 서비스 입니다.");
				layer_popup($("#layer8"));
 				//alert("로그인이 필요한 서비스 입니다.");
 				location.href = "/login/loginUsr.do";
 			}else{ */
 				$("#layer1").hide();
 				$(".tabcontent").removeClass("on");
 				$("ul#tabMenu li").removeClass("on");
 				$("ul#tabMenu li").eq(2).addClass("on");
 				$("#tab3").addClass("on");
 				
 				$("#lefttab2").removeClass("active");
				$("#lefttab3").addClass("active");
 				
 				ajaxcardList();
 			//}
 		});
 		
 		//주차요금선납 서비스 신청 stpe1
 		$("#btn_go_step2").click(function(){
 			// 위쪽으로 접속하는것도 박아야하지않나
 			// 비로그인시 로그인해야함
 			/* if(sessionChk == ""){
 				$("#applyPop8Text").html("로그인이 필요한 서비스 입니다.");
				layer_popup($("#layer8"));
 				//alert("로그인이 필요한 서비스 입니다.");
 				location.href = "/login/loginUsr.do";
 				
 			}else{ */
 				
 				ajaxgetInfo();
 				
 				$(".tabcontent").removeClass("on");
 				$("ul#tabMenu li").removeClass("on");
 				$("ul#tabMenu li").eq(1).addClass("on");
 				$("#tab2").addClass("on");
 			//}
 		});
 		
 		  //Layer Pop-up
 			$('.btn-apply').click(function(){
 		        var $href = $(this).attr('href');
 		        layer_popup($href);
 		    });
 		  
 		   $('ul.payment-division li').on({
 			  "click" : function(){
 				  	var activeTab = $(this).attr("data-tab");
 					$("ul.payment-division li").removeClass("checked");
 					$(this).addClass("checked");
 					
 					$(".division-content").removeClass("on");
 					$("#" + activeTab).addClass("on");
 			  } 
 		   });

 			
 		  	//주차요금 선납 결제정보
 		  	$(document).on("click",".vehicle-add, .small-btn, .small-btn-m", function(){
 		  		var target = $(this),
 		  			classChk = "vehicle-add" == target.attr("class") ? true : false;
 		  			index = classChk ? target.data("carindex") : target.prev(".vehicle-add").data("carindex"),
 		  			carNo = classChk ? target.text() : target.prev(".vehicle-add").text();
 		  			
 		  		SetTmAmt(index);	
 		  			
 		  		$('.information-payment').removeClass('hide');
				$('.information-payment').addClass('show');
 		  		$(".carnumber li:first-child span").text(carNo);
 		  		
 		  	});
 		  	
 		  	var accSum = 0;
 		  	
 		  	// 선납 기준정보 구분 변경 클릭이벤트
 		  	$('.payment-division').on({
 		  		"click" : function(){
 				     
 				    if($("#baseTm").hasClass('checked')){
 				    	$("#baseTmResult").val($("#accNumTm").val());
 				    }else if($("#baseAmt").hasClass('checked')){
 				    	$("#baseAmtResult").val($("#accNumAmt").val());
 				    }else {
 				    	$("#baseAllAmtResult").val($("#accNumAllAmt").val());
 				    }
 		  			
 		  		}
 		  	});
 		  	
 		  	// 선납 기준정보 증가수치 버튼 클릭이벤트
 			$('.btn_num').on({
 				"click" : function(){
 				    var number = ($(this).attr('value')).replace(/[^0-9]/g,'');			//증가치
 				    var plus_num = parseInt(number);
 				    var accSumTm = parseInt($("#baseTmResult").val());
 				    var accSumAmt = parseInt($("#baseAmtResult").val());
 				     
 				    var maxTm = parseInt($("#accNumMaxTm").val());
 				    var maxAmt = parseInt($("#accNumMaxAmt").val());
 				    
 					if($("#baseTm").hasClass('checked')){
 						
 						accSumTm = accSumTm + plus_num;
 						
 						if($("#baseTmResult").val() == ''){
 							accSumTm = (isNaN(accSumTm)) ? 0 : accSumTm;
 						}
 						
 						if(accSumTm > maxTm){
 							$("#applyPop8Text").html("<spring:message code='payment.jsp.content30'/>");
 							layer_popup($("#layer8"));
 							return false;
 						}
 						
 						$("#baseTmResult").val(accSumTm);
 					}else if($("#baseAmt").hasClass('checked')){
 						
 						accSumAmt = accSumAmt + plus_num;
 						
 						if($("#baseAmtResult").val() == ''){
 							accSumAmt = (isNaN(accSumAmt)) ? 0 : accSumAmt;
 						}
 						
 						if(accSumAmt > maxAmt){
 							$("#applyPop8Text").html("<spring:message code='payment.jsp.content31'/>");
 							layer_popup($("#layer8"));
 							//alert("주차요금(예상)을 초과할 수 없습니다.");
 							return false;
 						}
 						
 						$("#baseAmtResult").val(accSumAmt);
 					}else {
 						$("#baseAllAmtResult").val($("#accNumAllAmt").val());
 					}
 					
 				}
 			});
 		  	
		$("#cardAddBtn").on("click", function(){
			let $href = $(this).attr('href');
			layer_popup($href);
		});
		
		$("#parkingAddBtn").on("click", function(){
			let $href = $(this).attr('href');
			layer_popup($href);
			
			beforeTab = $(".park-list").children(".on").data("tab");
			
		});
		
		
		//마커 클릭 콜백 함수
		tpMap.markerClickCallback = function(idx) {
			return function(){
				tpMap.changeMarkerImages2(markerImages.getSmallOne());
				
				if(tpMap.positions[idx].useYn =="Y"){
					tpMap.markers[idx].setImage(markerImages.getShopBigOne());
					tpMap.markers[idx].setMap(tpMap.mapInstance);
				}else{
					tpMap.markers[idx].setImage(markerImages.getBigOne());
					tpMap.markers[idx].setMap(tpMap.mapInstance);
				}
				
				
			}
		};
		
		var _container = document.getElementById("div_map");
		
		$("#parkingMapAddBtn").on("click", function(){
			$("#parking-list").show();
			tpMap.mapInstance = null ; 
			
			var sectnChk = $("#pcParkingList").children("tr").data("select-sectnid") == allParking;
			
			// 전체 주차장 select 
			$.ajax({
				  url      : "<c:url value='/payment/parkingSearch.do' />"
				, type     : "POST"
				, dataType : "json"
				, success  : function(data){
					
					var list = data.data;
					var positions = [];
					
					tpMap.init(_container, 36.994834018423, 127.089357955884, 6, true, null, function(){tpMap.changeMarkerImages(markerImages.getSmallOne())});
					
					tpMap.setCurrentUserPosition();
					
					for(var i = 0; i < list.length; i++){
						
						var _parkingLot = {};
						
						_parkingLot.parkingNm = list[i].parkingNm;
						_parkingLot.parkingDivNm = "["+list[i].parkingDivNm+"]";
						_parkingLot.title = "["+list[i].parkingDivNm+"]"+ list[i].parkingNm + list[i].dtlbLdgNm;
						_parkingLot.parkingNormalAmt =  list[i].parkingNormalAmt;
						_parkingLot.parkingAddAmt =  list[i].parkingAddAmt;
						_parkingLot.amt =  list[i].parkingNormalAmt +" "+list[i].parkingAddAmt;
						_parkingLot.parkingWdaysUseTm =  list[i].parkingWdaysUseTm;
						_parkingLot.parkingWendUseTm =  list[i].parkingWendUseTm;
						_parkingLot.tm = list[i].parkingWdaysUseTm +" "+list[i].parkingWendUseTm;
						_parkingLot.sectnId = list[i].sectnId;
						_parkingLot.latlng = new daum.maps.LatLng(list[i].lat, list[i].lng) ;
						_parkingLot.useYn = 'N'; 
						
						if(sectnChk){
							
							_parkingLot.useYn = 'Y';
							
						}else{
							
							if(saveParkingMap[list[i].sectnId] != undefined){
								if(saveParkingMap[list[i].sectnId].selectChk){
									_parkingLot.useYn = 'Y'; 
								}
							}
							
						}
						
						positions.push(_parkingLot);
						
					}
					
					tpMap.setMarkers5(positions);
					tpMap.setOverlays3();
					
					tpMap.relayout();
				}
			  , error : function(request,error){
				  alertMessage("<spring:message code='payment.jsp.content4'/>");
				}
			}); 
		});
		
		fn_Pop_Close = function () {
			// 부모 창 스크롤 막기
			$("body").css("overflow-y", "auto");
		
			// 팝업, 팝업 배경 닫기
			$(".pop-cont, #parking-list").hide();
		};
		
		$(".btn-Close").on("click", function(){
			$(".dim").css("display","none");
			$("body").css("overflow","auto");
		});
		
		$(".park-list").on("click", function(){
			let tab_id = $(this).attr("data-tab"),
				target = $("#pcParkingList"),
				text = "";
			
			$(".park-list").removeClass("on");
			$(".parking-content").removeClass("on");
			
			$(this).addClass("on");
			$("#"+tab_id).addClass("on");
			
			if(allTab == tab_id){
				
				beforeParkingMap = {};
				saveParkingMap = {};
				$("#parkingSearchText").val("");
				parkingSearch();
				
				if(tab_id != beforeTab){
					
					text  = "<tr data-select-sectnid='all'><td colspan = '4' style='height: 100px;'><spring:message code='payment.jsp.content32'/></td></tr>";
					target.empty().append(text);
					
				}
				
				$("#layer-parking").hide();
				
			}
		
			
		});
		
		$("#parkingSearchSave").on("click", function(){
			
			saveParkingMap = $.extend(true, {}, beforeParkingMap);
			$("#layer-parking").hide();
			pcParkingList();
		});
		
		$("#parkingSearchCancel").on("click", function(){
			
			beforeParkingMap = $.extend(true, {}, saveParkingMap);
			parkingSearch();
			
		    if(beforeTab == allTab){
		    	
		    	$(".park-list").removeClass("on");
				$(".parking-content").removeClass("on");
		    	$("li[data-tab="+allTab+"]").addClass("on");
				$("#"+allTab).addClass("on");
				
		    }
		    
			$("#layer-parking").hide();
			
		});
		
		$(document).on("click", ".parkingTr", function(){
			
			var	target = $(this), 
				td = target.children("td"),
				th = target.children("th"),
				data = getTrData(target);
			
				clickChk = false;
			
				td.removeAttr("style");
				
			if(td.hasClass("select_parking")){
				
				delete beforeParkingMap[data.sectnId];
				td.removeClass("select_parking");
				
			}else{
				
				beforeParkingMap[data.sectnId] = setData(data);
				
				td.removeAttr("style");
				td.addClass("select_parking");
				
			}
			
		});
		
		$(document).on("mouseover", ".parkingTr", function(){
			
			var td = $(this).children("td");
			
			if(clickChk && !td.hasClass("select_parking")){
				
				td.css("background-color", "#FFFF7E");
				
			}
			
		});
		
		$(document).on("mouseleave", ".parkingTr", function(){
			
			var td = $(this).children("td");
			
				clickChk = true;
				
				td.removeAttr("style");
			
		});
		
		$(document).on("click", ".parkingMap", function(e){
			e.stopPropagation();
	  	});
		
		$("#parkingSearch").on("click", function(){
			parkingSearch();
		});
		
		$(document).on("click", ".cancelBtn", function(){
			
			var target = $(this);
			
			if(isMobile){
				
				delete beforeParkingMap[target.parents("table").eq(0).data("select-sectnid")];
				delete saveParkingMap[target.parents("table").eq(0).data("select-sectnid")];
				target.parents("table").eq(0).remove();
				
				if($("#mobileParkingList").children("table").length == 0){
					$("#mobileParkingList").append('<table class="parking-table mobile">'
						 +  '<caption class="sr-only"><spring:message code="payment.tab2.content22"/></caption>'
						 +  '<colgroup><col style="width:90%;" /><col style="width:10%;" /></colgroup>'
						 +  '<thead><tr><th colspan="2"><spring:message code="payment.jsp.content33"/></th></tr></thead></table>');
				}
				
			}else{
				
				delete beforeParkingMap[target.closest("td").closest("tr").data("select-sectnid")];
				delete saveParkingMap[target.closest("td").closest("tr").data("select-sectnid")];
				target.closest("td").closest("tr").remove();
				
				if($("#pcParkingList").children("tr").length == 0){
					$("#pcParkingList").append("<tr data-select-sectnid='empty'><td colspan='4' style='height: 100px;'><spring:message code='payment.jsp.content33'/></td></tr>");
				}
				
			}
			
		});
		
		$("#parkingAllAddBtn").on("click", function(){
			
			var target = $(this);
			
			if(target.hasClass(allParking)){
				
				target.text("<spring:message code='payment.tab2.content13'/>").removeClass(allParking);
				parkingList();
				
			}else{
				
				beforeParkingMap = {};
				saveParkingMap = {};
				target.text("<spring:message code='payment.jsp.content17'/>").addClass(allParking);
				parkingList(allParking);
				
			}
			
			$("#parkingMapAddBtn").toggle();
			
		});
		
 	});
 	
 	function parkingSearch(){
 		
 		var parkingSearchText = $("#parkingSearchText").val();
		
		if(parkingSearchText){
			
			parkingSearchText = parkingSearchText.trim();
			
		}
		
		$.ajax({
			  url      : "<c:url value='/payment/parkingSearch.do' />"
			, type     : "POST"
			, data     : {parkingSearchText : parkingSearchText	}
			, dataType : "json"
			, success  : function(list){
				
				if(isMobile){
					mobileParkingTable(list);
				}else{
					pcParkingTable(list);
				}
				
			}
			, error    : function(request,error){
				alertMessage("<spring:message code='payment.jsp.content4'/>");
			}
		}); 
		
 	}
 	
 	function pcParkingTable(list){
 		
 		var target = $("#pcParkingSearch"),
 			length = list.length,
			text = null;
 		
 		if(length === 0){
 			
 			text  = "<tr><td colspan='2' class='none-list'><spring:message code='payment.jsp.content34'/></td></tr>";
 				 
 		}else{
 			
 			for(var i = 0; i < length; i++){
 				
 				text += "<tr class='parkingTr' data-sectnid='"+list[i].sectnId+"'>" 
 				     +  "<th scople='col'>"
 				     +  "<span class='parkingDivNm'>["+list[i].parkingDivNm+"]</span><a href='#;' class='parkingNm'>"+list[i].parkingNm+"</a>"
 				     +  "</th>";
 				     
 				if(sectnChk(list[i].sectnId)){
 					
 				text += "<td scope='col' class='all_parking select_parking'>";
 				
 				}else{
 				    		
 				text += "<td scope='col' calss='all_parking'>";  
 				
 				}
 				    	
 				text += "<ul>"
 				     +  "<li><b class='parkingAmt'>"+list[i].parkingNormalAmt+"</b><b class='parkingAddAmt'>"+list[i].parkingAddAmt+"</b><b>,</b></li>"
 				     +  "<li><span class='parkingWdaysTm'>"+list[i].parkingWdaysUseTm+"</span><span class='parkingWendTm' style='margin-left:5px;'>"+list[i].parkingWendUseTm+"</li>"
 				     +  "</ul>"
 				     +  "<div>"
 				     +  "<input type='button' value='지도보기' class='parkingMap' data-lat='"+list[i].lat+"' data-lng='"+list[i].lng+"' data-dtlbldgnm='"+list[i].dtlBldgNm+"' />"
 				     +  "</div>"
 				     +  "</td>"
 				     +  "</tr>";
 			}
 			
 		}
 		
 		target.empty().append(text);
 		
 		text = null;
 		
 	}
 	
 	function mobileParkingTable(list){
 		
 		var target =$("#mobileParkingSearch"),
 			text = null;
 		
		if(list.length === 0){
 			
 		}else{
 			
 			for(var i = 0; i < length; i++){
 				
 			}
 			
 		}
		
		target.empty().append(text);
		
		text = null;
 	}
 	
 	function pcParkingList(flag){
 		
 		var target = $("#pcParkingList"),
			text = "";
 		
 		if(allParking == flag){
 			
 			text = "<tr data-select-sectnid='all'><td colspan = '4' style='height: 100px;'><spring:message code='payment.jsp.content32'/></td></tr>";
 			
 		}else{
 		
	 		if($.isEmptyObject(saveParkingMap)){
	 			text += "<tr data-select-sectnid='empty'><td colspan='4' style='height: 100px;'><spring:message code='payment.jsp.content33'/></td></tr>";
	 		}
	 		
	 		$.each(saveParkingMap, function(index, item){ 
	 			
		 		text += "<tr data-select-sectnid='"+item.sectnId+"'>"
		 			 +  "<td scope='row'>"
		 			 +  "<a href='#;'>"+item.parkingDivNm+""+item.parkingNm+"</a>"
		 			 +  "</td>"
		 			 +  "<td>"
		 			 +  "<ul>"
		 			 +  "<li>"+item.parkingNormalAmt+"</li>"
		 			 +  "<li>"+item.parkingAddAmt+"</li>"
		 			 +  "</ul>"
		 			 +  "</td>"
		 			 +  "<td>"
		 			 +  "<ul>"
		 			 +  "<li>"+item.parkingWdaysUseTm+"</li>"
		 			 +  "<li>"+item.parkingWendUseTm+"</li>"
		 			 +  "</ul>"
		 			 +  "</td>"
		 			 +  "<td><a href='#;' class='cancelBtn'><spring:message code='payment.tab2.content25'/></a></td>"
		 			 +  "</tr>";
	 	 			 
	 		});
 		
 		}
				
		target.empty().append(text);
		
		text = null; 
		
 	}
 	
 	function mobileParkingList(flag){
 		
 		var target = $("#mobileParkingList"),
			text = "";
 		
 		if(allParking == flag){
 			
 			text += "<table class='parking-table mobile' data-select-sectnid='all'>"
 				 +  '<caption class="sr-only"><spring:message code="payment.jsp.content35"/></caption>'
				 +  '<colgroup><col style="width:90%;" /><col style="width:10%;" /></colgroup>'
				 +  '<thead><tr><th colspan="2"><spring:message code="payment.jsp.content32"/></th></tr></thead></table>';
 			
 		}else{
 			
 			if($.isEmptyObject(saveParkingMap)){
 				text += "<table class='parking-table mobil' data-select-sectnid='empty'>"
 					 +  '<caption class="sr-only"><spring:message code="payment.jsp.content35"/></caption>'
 					 +  '<colgroup><col style="width:90%;" /><col style="width:10%;" /></colgroup>'
 					 +  '<thead><tr><th colspan="2"><spring:message code="payment.jsp.content32"/></th></tr></thead></table>';
 			}
 			
 			$.each(saveParkingMap, function(index, item){ 
 				
 				text += "<table class='parking-table mobile' data-select-sectnid='"+item.sectnId+"'>"
 				     +  '<caption class="sr-only"><spring:message code="payment.jsp.content35"/></caption>'
 				     +  '<colgroup><col style="width:90%;" /><col style="width:10%;" /></colgroup>'
 					 +  '<thead><tr><th>'+item.parkingDivNm+item.parkingNm+'</th>	<th><a href="#;" class ="cancelBtn"><spring:message code="payment.tab2.content25"/></a></th>'
 					 +  '</tr></thead>	<tbody><tr><td colspan="2"><ul><li>'+item.parkingNormalAmt+'</li><li>'+ item.parkingAddAmt+'</li></ul></td><tr>'
 					 +  '<tr><td colspan="2"><ul><li>'+item.parkingWdaysUseTm+'</li><li>'+item.parkingWendUseTm+'</li></ul></td><tr>'
 					 +  '</tbody></table>';
 		 			 
 			});
 			
 		}
		
		target.empty().append(text);
		
		text = null; 
	
 	}
 	
 	function parkingList(flag){
 		
 		if(isMobile){
 			mobileParkingList(flag);
 		}else{
 			pcParkingList(flag);
 		}
 		
 	}
 	
 	function sectnChk(sectnId){
 		return beforeParkingMap.hasOwnProperty(sectnId);
 	}
 	
 	function getTrData(target){
 		
		var td = target.children("td"),
			th = target.children("th"),
			sectnId = target.data("sectnid");
			parkingDivNm = th.children(".parkingDivNm").text(),
			parkingNm = th.children(".parkingNm").text(),
			parkingNormalAmt = td.find(".parkingNormalAmt").text(),
			parkingAddAmt = td.find(".parkingAddAmt").text(),
			parkingWdaysUseTm = td.find(".parkingWdaysUseTm").text(),
			parkingWendUseTm = td.find(".parkingWendUseTm").text(),
			lat = td.find(".parkingMap").data("lat"),
			lng = td.find(".parkingMap").data("lng"),
			dtlBldgNm = td.find(".parkingMap").data("dtlbldgnm"),
			selectChk = true;
 		
		return {
				 sectnId : sectnId,
				 parkingDivNm : parkingDivNm,
				 parkingNm : parkingNm,
				 parkingNormalAmt : parkingNormalAmt,
				 parkingAddAmt : parkingAddAmt,
				 parkingWdaysUseTm : parkingWdaysUseTm,
				 parkingWendUseTm : parkingWendUseTm,
				 lat : lat,
				 lng : lng,
				 dtlBldgNm : dtlBldgNm,
				 selectChk : selectChk
			   };
	
 	}
 	
 	function getObjData(obj){
 		return {
				 sectnId : obj.sectnId,
				 parkingDivNm : obj.parkingDivNm,
				 parkingNm : obj.parkingNm,
				 parkingNormalAmt : obj.parkingNormalAmt,
				 parkingAddAmt : obj.parkingAddAmt,
				 parkingWdaysUseTm : obj.parkingWdaysUseTm,
				 parkingWendUseTm : obj.parkingWendUseTm,
				 lat : obj.lat,
				 lng : obj.lng,
				 dtlBldgNm : obj.dtlBldgNm,
				 selectChk : true
			   };
 	}
 	
 	function setData(data){
		return $.extend(true, {}, data);
 	}
 	
 	function btn_carlistXlsx(){
 		var regStartDt = $("#regStartDt").val();
 		var regEndDt = $("#regEndDt").val();
 		var carNo = $("#car-number_carNo").val();
 		var catagory = "car_payment_list";
 		var applyId = $("#applyId").val();
 		
 		$("#xlsxRegStartDt").val(regStartDt);
 		$("#xlsxRegEndDt").val(regEndDt);
 		$("#xlsxCarNo").val(carNo);
 		$("#xlsxApplyId").val(applyId);
 		$("#catagory").val(catagory);
 		
		$("#btnForm").attr("action", "<c:url value='/payment/select_payment_car.do?mode=xlsx'/>");
		$("#btnForm").submit();
		
		loading.hide();
 	};
 	
 	// 지도 주차장 선택 부분
 	function setId(idx) {
 		var getSectnId = tpMap.positions[idx].sectnId;
 		var getParkingNormalAmt = tpMap.positions[idx].parkingNormalAmt;
 		var getParkingAddAmt = tpMap.positions[idx].parkingAddAmt;
 		var getParkingWdaysUseTm = tpMap.positions[idx].parkingWdaysUseTm;
 		var getParkingWendUseTm = tpMap.positions[idx].parkingWendUseTm;
 		var getParkingNm = tpMap.positions[idx].parkingNm;
 		var getParkingDivNm = tpMap.positions[idx].parkingDivNm;
 		
 		var getAmt = tpMap.positions[idx].amt;
 		var getTm = tpMap.positions[idx].tm;
 		
 		var parkingArray = {};
 		
 		parkingArray.parkingNm = getParkingNm;
 		parkingArray.parkingDivNm = getParkingDivNm;
 		parkingArray.parkingNormalAmt = getParkingNormalAmt;
 		parkingArray.parkingAddAmt = getParkingAddAmt;
 		parkingArray.parkingWdaysUseTm = getParkingWdaysUseTm;
 		parkingArray.parkingWendUseTm = getParkingWendUseTm;
 		parkingArray.sectnId = getSectnId;
 		parkingArray.selectChk = true;
 		
 		saveParkingMap[getSectnId] = parkingArray;
 		beforeParkingMap = $.extend(true, {}, saveParkingMap);
 		
 		parkingList();
 		
 		closeOverlay(idx);
		fn_Pop_Close();
	}
  	
 	// 팝업창 닫기버튼
 	$(".popupclose").on("click", function(){
 		location.reload();
 	});
 	
</script>	

</html>			